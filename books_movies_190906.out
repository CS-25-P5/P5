Running on ailab-l4-09
Start time: Tue Dec 16 02:41:24 CET 2025
Activating virtual environment...
Python path: /ceph/home/student.aau.dk/vo55zp/projects/P5/venv/bin/python3
Python version: Python 3.10.12
Running on ailab-l4-09
Start time: Tue Dec 16 02:41:24 CET 2025
Starting pipeline...

=== Running pipeline with weights: relevance=0.5, diversity=0.5 ===
Starting pipeline for movies train
Train matrix: (671, 1242), Val matrix: (610, 1242)
Best MF params: {'k': 60, 'alpha': 0.005, 'lambda_': 0.2}, RMSE=1.0411
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6502
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6564
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mf_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_02-42-00/mf_train_100000_loss_history.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Pipeline for movies train finished successfully!
Start movies test pipeline 
[DEBUG] Filtered users: 613
[DEBUG] Filtered items: 868
[DEBUG] Sample users: [2, 3, 4, 5, 6]
[DEBUG] Sample items: ['101', '102', '104', '1049', '105']
[DEBUG] Predicted ratings shape: (613, 868)
[DEBUG] Min/max predicted rating: 0.8305390614491499/5.705492834516667
MF predictions saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_02-42-00/mf_test_100000_top_50.csv
[DEBUG] Top-N CSV rows: 30650
[DEBUG] Unique users in CSV: 613
[DEBUG] Unique items in CSV: 92
[DEBUG] Sample rows:
   userId  rank  itemId  predictedRating
0       2     1     549         4.414122
1       2     2    1945         4.358058
2       2     3     858         4.341724
3       2     4     318         4.337373
4       2     5     905         4.319272
[DEBUG] Number of candidate items: 92
[DEBUG] Sample candidate items: ['549', '1945', '858', '318', '905']
[DEBUG] predicted_ratings_top_n shape: (613, 92)
[DEBUG] Non-zero entries: 30650
[DEBUG] Max predicted rating: 5.705492834516667
Missing items: {'62', '765', '1907', '6957', '2059', '2082', '340', '8970', '609', '440', '84944', '1586', '4995', '2694', '85788', '4886', '6', '452', '616', '160', '74946', '83613', '2268', '1580', '2313', '2860', '1882', '481', '6537', '429', '2282', '2699', '8985', '2302', '2099', '17', '1588', '1374', '1092', '20', '431', '480', '81', '6440', '379', '6058', '2395', '2269', '2728', '1414', '1375', '550', '39183', '288', '82', '2779', '613', '63859', '6947', '1407', '543', '2335', '77561', '2140', '2616', '155', '68954', '8366', '8810', '558', '1682', '1994', '2161', '141', '227', '2761', '39446', '4896', '53129', '902', '1995', '708', '2001', '107', '786', '627', '1645', '26712', '4974', '165', '3090', '2528', '2109', '1587', '7090', '1610', '54001', '3082', '2058', '4701', '928', '3160', '46976', '784', '51540', '2959', '1884', '280', '673', '691', '778', '225', '3168', '2770', '231', '169', '64', '8011', '140174', '1641', '2261', '95', '381', '62999', '2153', '1394', '110', '1779', '2355', '50189', '466', '3536', '53000', '144', '1285', '2122', '917', '2142', '6593', '2436', '4641', '16', '2094', '4191', '2116', '6283', '2433', '21', '1785', '6436', '2252', '4031', '2348', '177', '1732', '2009', '345', '5481', '3418', '1611', '805', '74510', '4012', '2890', '2567', '1378', '3016', '333', '65', '339', '102', '540', '910', '541', '163', '31685', '2232', '3638', '1701', '172', '3097', '4857', '1594', '4441', '150', '64983', '1590', '2012', '2124', '1589', '1958', '2687', '841', '914', '552', '253', '508', '4638', '523', '8966', '2135', '799', '838', '317', '2321', '334', '2455', '4823', '22', '2640', '3980', '551', '2000', '45186', '292', '3556', '1372', '942', '1376', '3578', '6643', '2383', '3176', '7451', '2143', '415', '272', '6620', '1673', '1975', '327', '2565', '4025', '54503', '502', '1835', '1951', '2749', '4228', '924', '1923', '1831', '30793', '79', '553', '262', '3635', '1894', '2457', '97938', '2080', '2447', '640', '1244', '2022', '1396', '1127', '932', '2701', '11', '1834', '1416', '1093', '4816', '1721', '331', '2166', '314', '2657', '8464', '1726', '1269', '315', '53519', '2642', '4977', '1968', '587', '1259', '3698', '5066', '4880', '1257', '1687', '81229', '1073', '319', '2046', '1911', '1653', '36529', '804', '3396', '442', '839', '260', '648', '1552', '186', '2134', '3178', '4975', '14', '3701', '1271', '1246', '33166', '2671', '4734', '215', '637', '2089', '2139', '1566', '1957', '471', '112', '5620', '6535', '1772', '1729', '788', '2017', '2428', '982', '1688', '235', '8645', '2067', '535', '1895', '1367', '2100', '52885', '1499', '1272', '276', '4979', '332', '195', '2002', '101', '6978', '2263', '5121', '2463', '104', '1371', '2151', '920', '89', '33660', '1405', '2722', '54272', '93840', '2087', '24', '40819', '4148', '2253', '6552', '2160', '457', '3173', '1278', '585', '2193', '3594', '3060', '135', '2011', '2014', '3011', '2297', '955', '2033', '196', '2114', '48385', '18', '3061', '107406', '1888', '3083', '216', '7445', '198', '662', '7980', '806', '1992', '8665', '1702', '2502', '337', '5902', '5608', '6934', '482', '170', '2805', '84187', '70', '8874', '1917', '3081', '5061', '509', '36401', '79553', '45722', '1619', '595', '88', '1049', '8371', '653', '612', '500', '265', '40629', '1947', '8368', '949', '3034', '3101', '4034', '31696', '88744', '455', '185', '12', '2787', '2084', '84601', '8981', '1875', '594', '2527', '380', '377', '1391', '4255', '47610', '2034', '1949', '3549', '1680', '383', '1380', '3565', '1213', '678', '3', '423', '46972', '588', '2734', '1262', '2312', '2115', '1544', '1479', '2294', '153', '2262', '168', '6373', '55765', '1125', '1964', '19', '1967', '5956', '44022', '2038', '41566', '5060', '348', '8873', '5064', '36519', '1377', '2759', '1791', '3004', '2078', '2088', '213', '207', '2333', '5247', '497', '5680', '531', '145', '47099', '1562', '1387', '2105', '161', '1836', '532', '5816', '950', '3117', '180', '2291', '891', '2018', '2861', '522', '1954', '2841', '2013', '2617', '3146', '2988', '223', '1792', '861', '1997', '1690', '1088', '2349', '277', '1370', '647', '2054', '2010', '986', '55721', '3052', '2334', '2966', '249', '427', '2112', '1124', '5881', '1713', '111759', '46578', '1091', '1584', '224', '592', '1985', '593', '5686', '58', '293', '4254', '2791', '2459', '222', '7454', '4958', '1722', '4970', '261', '338', '586', '59387', '158', '1788', '3210', '714', '3489', '2762', '1249', '1956', '1284', '1833', '3397', '15', '5483', '94959', '2028', '3527', '1961', '2978', '1366', '349', '42011', '81847', '44191', '2605', '241', '762', '49530', '832', '909', '1162', '8014', '1885', '1639', '783', '2108', '3526', '596', '8984', '798', '4889', '44004', '1581', '5991', '849', '173', '4709', '2324', '3763', '2239', '1389', '524', '513', '1734', '45431', '55', '919', '1266', '468', '8973', '1809', '1909', '2123', '1265', '2662', '3581', '410', '2989', '300', '1921', '38061', '605', '800', '2110', '1633', '4247', '562', '1556', '239', '6003', '3051', '1487', '434', '2006', '5147', '628', '711', '3479', '2015', '47518', '85414', '3483', '5528', '3699', '441', '247', '1358', '428', '5', '1608', '830', '2266', '8961', '350', '2111', '236', '74458', '546', '1959', '44694', '539', '123', '4232', '58306', '1485', '59333', '1103', '2141', '86332', '1858', '1615', '2005', '454', '1593', '1777', '1991', '1944', '1282', '1892', '837', '105', '2912', '2085', '4723', '435', '2003', '204', '27721', '329', '1887', '2118', '2144', '25750', '378', '4369', '1251', '31410', '2993', '193', '3175', '3512', '809', '303', '3053', '866', '364', '4011', '252', '256', '2', '36527', '2288', '671', '30707', '1573', '2470', '597', '1678', '2371', '316', '8833', '1393', '1059', '1488', '6936', '1373', '3577', '436', '4351', '2926', '266', '802', '494', '879', '900', '1717', '344', '590', '78088', '4643', '1090', '3033', '26133', '3114', '1597', '1247', '2004', '2539', '492', '1676', '4344', '661', '780', '1950', '2125', '2069', '25', '89492', '1918', '342', '40815', '1591'}
MF test predictions saved to: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_02-42-00/mf_test_100000_predictions.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_02-42-00/mmr_test_100000_cosine_top_50.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_02-42-00/mmr_test_100000_jaccard_top_50.csv
Pipeline for movies test finished successfully!
