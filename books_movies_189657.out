Running on ailab-l4-06
Start time: Fri Dec 12 20:54:47 CET 2025
Activating virtual environment...
Python path: /ceph/home/student.aau.dk/vo55zp/projects/P5/venv/bin/python3
Python version: Python 3.10.12
Running on ailab-l4-06
Start time: Fri Dec 12 20:54:47 CET 2025
Starting pipeline...

=== Running pipeline with weights: relevance=0.4, diversity=0.6 ===
Starting pipeline for movies train
Train matrix: (610, 1242), Val matrix: (610, 1242)
Best MF params: {'k': 60, 'alpha': 0.01, 'lambda_': 0.1}, RMSE=0.8825
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.15000000000000002 with score 0.6313
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.05 with score 0.6028
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mf_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-12_20-54-49/mf_train_100000_loss_history.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Pipeline for movies train finished successfully!
Start movies test pipeline 
MF predictions saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-12_20-54-49/mf_test_100000_top_50.csv
MF test predictions saved to: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-12_20-54-49/mf_test_100000_predictions.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-12_20-54-49/mmr_test_100000_cosine_top_50.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-12_20-54-49/mmr_test_100000_jaccard_top_50.csv
Log MMR data
Pipeline for movies test finished successfully!
Starting pipeline for books train
Train matrix: (1584, 2559), Val matrix: (1584, 2559)
Best MF params: {'k': 40, 'alpha': 0.005, 'lambda_': 0.1}, RMSE=0.8865
Validation data: 9780 ratings
Item IDs length: 2559
Max column index: 2558
Best lambda: 0.0 with score 0.9954
Validation data: 9780 ratings
Item IDs length: 2559
Max column index: 2558
Best lambda: 0.0 with score 0.9954
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/books/mf_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/books/2025-12-12_21-06-23/mf_train_100000_loss_history.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/books/mmr_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/books/mmr_train_experiment_log.csv
Pipeline for books train finished successfully!
Start books test pipeline 
MF predictions saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/books/2025-12-12_21-06-23/mf_test_100000_top_50.csv
MF test predictions saved to: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/books/2025-12-12_21-06-23/mf_test_100000_predictions.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/books/2025-12-12_21-06-23/mmr_test_100000_cosine_top_50.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/books/2025-12-12_21-06-23/mmr_test_100000_jaccard_top_50.csv
Log MMR data
Pipeline for books test finished successfully!

=== Running pipeline with weights: relevance=0.2, diversity=0.8 ===
Starting pipeline for movies train
Train matrix: (610, 1242), Val matrix: (610, 1242)
Best MF params: {'k': 60, 'alpha': 0.01, 'lambda_': 0.1}, RMSE=0.8825
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.15000000000000002 with score 0.8157
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.1 with score 0.8000
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mf_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-12_21-38-40/mf_train_100000_loss_history.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Pipeline for movies train finished successfully!
Start movies test pipeline 
MF predictions saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-12_21-38-40/mf_test_100000_top_50.csv
MF test predictions saved to: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-12_21-38-40/mf_test_100000_predictions.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-12_21-38-40/mmr_test_100000_cosine_top_50.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-12_21-38-40/mmr_test_100000_jaccard_top_50.csv
Log MMR data
Pipeline for movies test finished successfully!
Starting pipeline for books train
Train matrix: (1584, 2559), Val matrix: (1584, 2559)
Best MF params: {'k': 40, 'alpha': 0.005, 'lambda_': 0.1}, RMSE=0.8865
Validation data: 9780 ratings
Item IDs length: 2559
Max column index: 2558
Best lambda: 0.0 with score 0.9939
Validation data: 9780 ratings
Item IDs length: 2559
Max column index: 2558
Best lambda: 0.0 with score 0.9939
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/books/mf_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/books/2025-12-12_21-50-24/mf_train_100000_loss_history.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/books/mmr_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/books/mmr_train_experiment_log.csv
Pipeline for books train finished successfully!
Start books test pipeline 
MF predictions saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/books/2025-12-12_21-50-24/mf_test_100000_top_50.csv
MF test predictions saved to: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/books/2025-12-12_21-50-24/mf_test_100000_predictions.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/books/2025-12-12_21-50-24/mmr_test_100000_cosine_top_50.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/books/2025-12-12_21-50-24/mmr_test_100000_jaccard_top_50.csv
Log MMR data
Pipeline for books test finished successfully!

=== Running pipeline with weights: relevance=0.0, diversity=0.1 ===
Starting pipeline for movies train
Train matrix: (610, 1242), Val matrix: (610, 1242)
Best MF params: {'k': 60, 'alpha': 0.01, 'lambda_': 0.1}, RMSE=0.8825
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.15000000000000002 with score 0.1000
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.1 with score 0.1000
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mf_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-12_22-19-46/mf_train_100000_loss_history.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Pipeline for movies train finished successfully!
Start movies test pipeline 
MF predictions saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-12_22-19-46/mf_test_100000_top_50.csv
MF test predictions saved to: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-12_22-19-46/mf_test_100000_predictions.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-12_22-19-46/mmr_test_100000_cosine_top_50.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-12_22-19-46/mmr_test_100000_jaccard_top_50.csv
Log MMR data
Pipeline for movies test finished successfully!
Starting pipeline for books train
Train matrix: (1584, 2559), Val matrix: (1584, 2559)
Best MF params: {'k': 40, 'alpha': 0.005, 'lambda_': 0.1}, RMSE=0.8865
Validation data: 9780 ratings
Item IDs length: 2559
Max column index: 2558
Best lambda: 0.05 with score 0.1000
Validation data: 9780 ratings
Item IDs length: 2559
Max column index: 2558
Best lambda: 0.05 with score 0.1000
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/books/mf_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/books/2025-12-12_22-31-35/mf_train_100000_loss_history.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/books/mmr_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/books/mmr_train_experiment_log.csv
Pipeline for books train finished successfully!
Start books test pipeline 
MF predictions saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/books/2025-12-12_22-31-35/mf_test_100000_top_50.csv
MF test predictions saved to: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/books/2025-12-12_22-31-35/mf_test_100000_predictions.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/books/2025-12-12_22-31-35/mmr_test_100000_cosine_top_50.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/books/2025-12-12_22-31-35/mmr_test_100000_jaccard_top_50.csv
Log MMR data
Pipeline for books test finished successfully!
