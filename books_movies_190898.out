Running on ailab-l4-01
Start time: Tue Dec 16 01:01:55 CET 2025
Activating virtual environment...
Python path: /ceph/home/student.aau.dk/vo55zp/projects/P5/venv/bin/python3
Python version: Python 3.10.12
Running on ailab-l4-01
Start time: Tue Dec 16 01:01:55 CET 2025
Starting pipeline...

=== Running pipeline with weights: relevance=0.5, diversity=0.5 ===
Starting pipeline for movies train
Train matrix: (671, 1242), Val matrix: (610, 1242)
Best MF params: {'k': 60, 'alpha': 0.005, 'lambda_': 0.2}, RMSE=1.0411
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6502
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6564
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mf_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_01-02-32/mf_train_100000_loss_history.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Pipeline for movies train finished successfully!
Start movies test pipeline 
[DEBUG] Filtered users: 613
[DEBUG] Filtered items: 868
[DEBUG] Sample users: [2, 3, 4, 5, 6]
[DEBUG] Sample items: ['101', '102', '104', '1049', '105']
[DEBUG] Predicted ratings shape: (613, 868)
[DEBUG] Min/max predicted rating: 0.8305390614491499/5.705492834516667
MF predictions saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_01-02-32/mf_test_100000_top_50.csv
[DEBUG] Top-N CSV rows: 30650
[DEBUG] Unique users in CSV: 613
[DEBUG] Unique items in CSV: 92
[DEBUG] Sample rows:
   userId  rank  itemId  predictedRating
0       2     1     549         4.414122
1       2     2    1945         4.358058
2       2     3     858         4.341724
3       2     4     318         4.337373
4       2     5     905         4.319272
[DEBUG] Number of candidate items: 92
[DEBUG] Sample candidate items: ['549', '1945', '858', '318', '905']
[DEBUG] predicted_ratings_top_n shape: (613, 92)
[DEBUG] Non-zero entries: 30650
[DEBUG] Max predicted rating: 5.705492834516667
Missing items: {'917', '6537', '112', '195', '89492', '3114', '30793', '595', '293', '508', '1734', '612', '830', '168', '36519', '3210', '3081', '902', '140174', '2722', '673', '2118', '435', '8011', '2141', '40815', '1921', '79553', '1090', '317', '84944', '1653', '1959', '3980', '2728', '1785', '1722', '2988', '1366', '5608', '1376', '765', '1641', '4995', '1259', '85788', '4232', '1682', '805', '640', '102', '2334', '65', '3578', '85414', '8984', '1726', '1639', '806', '1375', '3699', '8810', '186', '1485', '3173', '441', '111759', '714', '215', '588', '4970', '2436', '609', '1992', '1791', '2099', '1809', '2110', '2288', '950', '2013', '919', '932', '2151', '1414', '454', '2779', '786', '6957', '3581', '1884', '955', '2291', '8833', '1882', '3396', '2015', '4889', '594', '648', '1835', '2105', '513', '1389', '2034', '222', '2565', '809', '492', '586', '97938', '2038', '1372', '1633', '1834', '381', '1702', '553', '6058', '31696', '314', '1566', '59387', '334', '2616', '8014', '8966', '662', '39446', '300', '47099', '169', '1394', '7445', '628', '2463', '2791', '2046', '377', '540', '163', '2109', '2005', '1265', '101', '1892', '2395', '982', '2262', '33660', '26712', '2640', '500', '1487', '16', '535', '2617', '2687', '637', '5061', '2', '1073', '41566', '1358', '1967', '1285', '910', '380', '593', '1488', '123', '4025', '2749', '74946', '2058', '2447', '1645', '1059', '1272', '4034', '350', '2333', '2926', '379', '798', '249', '1608', '2100', '266', '1690', '2324', '942', '58306', '81', '8371', '1995', '6552', '455', '38061', '3489', '4723', '509', '340', '4974', '68954', '185', '2457', '7454', '2297', '1729', '2161', '2527', '1573', '177', '2567', '558', '920', '3082', '2069', '5956', '6936', '107', '1093', '17', '2890', '3146', '1888', '2018', '223', '345', '36401', '332', '543', '5066', '1615', '2605', '5060', '5881', '1580', '8961', '8973', '265', '288', '4958', '25750', '2153', '46972', '2123', '2528', '502', '1391', '2082', '8645', '333', '1894', '2459', '1593', '4701', '2033', '276', '1373', '1688', '3594', '4012', '804', '891', '8464', '2841', '653', '1377', '1284', '8368', '55765', '27721', '2004', '605', '4441', '6947', '74510', '1556', '153', '1479', '207', '329', '337', '541', '4823', '349', '155', '2253', '344', '1103', '3034', '839', '3701', '1895', '46578', '3052', '1918', '25', '4351', '77561', '800', '40629', '141', '4979', '457', '1909', '613', '2085', '1552', '1788', '331', '31410', '1092', '161', '5481', '2302', '1611', '2734', '44694', '585', '550', '3033', '1836', '784', '2017', '55', '1405', '4643', '802', '783', '480', '3', '2143', '1610', '2912', '1994', '26133', '1416', '213', '3536', '235', '53519', '1717', '53129', '2134', '1680', '327', '1249', '1944', '4977', '597', '909', '1964', '93840', '452', '62', '838', '339', '429', '173', '1393', '1858', '62999', '2022', '6', '3479', '1091', '1213', '2699', '1947', '2761', '30707', '415', '900', '3763', '2108', '4344', '1367', '3556', '2282', '36529', '4191', '253', '494', '6436', '44191', '1954', '1257', '524', '64983', '3565', '383', '196', '434', '590', '2993', '2455', '5680', '2084', '4254', '1956', '2266', '79', '88', '5816', '2087', '280', '1499', '5902', '1396', '1586', '2001', '1584', '410', '7090', '6643', '50189', '12', '2002', '2116', '2239', '539', '6440', '3117', '1251', '144', '1125', '1374', '2959', '3004', '316', '4031', '532', '89', '3090', '4886', '2371', '1885', '2003', '2114', '3053', '879', '986', '5147', '36527', '1282', '4148', '5', '1833', '778', '292', '1949', '2232', '33166', '1678', '1831', '1911', '2028', '1088', '2383', '2502', '2054', '54272', '2671', '1590', '2662', '3527', '1562', '4880', '2294', '4641', '2335', '24', '2805', '8981', '1961', '841', '616', '3698', '5064', '338', '3160', '471', '47610', '522', '6593', '81229', '928', '2428', '2010', '2012', '1676', '2135', '4896', '378', '54001', '562', '552', '70', '6535', '1162', '3011', '145', '4255', '671', '1581', '837', '2139', '468', '3097', '44004', '762', '20', '428', '8873', '84187', '1687', '1271', '1278', '1779', '4011', '40819', '4369', '1951', '3060', '1968', '31685', '3635', '165', '4734', '4816', '949', '49530', '1246', '2263', '1875', '2642', '45431', '466', '1950', '708', '482', '1262', '2140', '86332', '531', '55721', '46976', '2144', '2142', '198', '51540', '1732', '231', '3577', '2694', '3418', '48385', '58', '2122', '2160', '1589', '74458', '1371', '8970', '47518', '2111', '523', '1594', '2011', '11', '1244', '4709', '2080', '431', '627', '2000', '6373', '788', '2312', '1907', '1777', '1985', '2470', '83613', '1127', '1673', '2989', '225', '647', '1887', '1124', '1975', '3061', '104', '481', '63859', '224', '2115', '2770', '8366', '2268', '436', '110', '81847', '3397', '342', '2261', '94959', '84601', '2787', '44022', '5483', '2252', '2009', '2193', '3638', '861', '172', '1991', '236', '2269', '1792', '1957', '2701', '3016', '5620', '260', '2539', '227', '3175', '866', '8985', '3101', '2067', '42011', '15', '661', '135', '262', '1049', '1247', '1407', '5121', '8874', '45722', '18', '88744', '2860', '1269', '95', '150', '1370', '1721', '2313', '832', '19', '2348', '2124', '261', '22', '2349', '2094', '6283', '160', '170', '204', '3549', '423', '303', '2088', '2321', '239', '4638', '5991', '7451', '4975', '52885', '8665', '2125', '241', '849', '1772', '348', '256', '39183', '711', '2355', '1923', '54503', '59333', '78088', '82', '1713', '596', '497', '4247', '4857', '1387', '3176', '1544', '180', '2078', '5528', '1587', '1917', '6934', '1597', '64', '1378', '272', '1591', '2059', '1701', '2657', '2861', '364', '2762', '799', '442', '2112', '5686', '252', '6620', '924', '440', '1380', '678', '5247', '319', '691', '914', '2433', '1958', '427', '216', '3512', '7980', '2759', '2166', '193', '3083', '3178', '546', '3051', '2006', '247', '14', '53000', '315', '107406', '780', '1266', '3483', '3168', '21', '1997', '105', '2014', '3526', '551', '592', '6003', '2978', '158', '1619', '45186', '2089', '1588', '587', '2966', '277', '4228', '6978'}
MF test predictions saved to: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_01-02-32/mf_test_100000_predictions.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_01-02-32/mmr_test_100000_cosine_top_50.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_01-02-32/mmr_test_100000_jaccard_top_50.csv
Pipeline for movies test finished successfully!
