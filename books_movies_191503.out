Running on ailab-l4-09
Start time: Tue Dec 16 15:19:33 CET 2025
Activating virtual environment...
Python path: /ceph/home/student.aau.dk/vo55zp/projects/P5/venv/bin/python3
Python version: Python 3.10.12
Running on ailab-l4-09
Start time: Tue Dec 16 15:19:33 CET 2025
Starting pipeline...

=== Running pipeline with weights: relevance=0.5, diversity=0.5 ===
Starting pipeline for movies train
Train matrix: (671, 1242), Val matrix: (610, 1242)
Best MF params: {'k': 60, 'alpha': 0.005, 'lambda_': 0.2}, RMSE=1.0411
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6483
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6539
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mf_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_15-20-10/mf_train_100000_loss_history.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Pipeline for movies train finished successfully!
Start movies test pipeline 
[DEBUG] Filtered users: 613
[DEBUG] Filtered items: 1242
[DEBUG] Sample users: [2, 3, 4, 5, 6]
[DEBUG] Sample items: ['101', '101362', '1018', '102', '1023']
[DEBUG] Predicted ratings shape: (613, 1242)
[DEBUG] Min/max predicted rating: 0.8305390614491499/5.737256786033441
predicted_ratings.shape: (613, 1242)
R_filtered.shape: (613, 1178)
MF predictions saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_15-20-10/mf_test_100000_top_50.csv
[DEBUG] Top-N CSV rows: 30650
[DEBUG] Unique users in CSV: 613
[DEBUG] Unique items in CSV: 108
[DEBUG] Sample rows:
   userId  rank  itemId  predictedRating
0       2     1     549         4.414122
1       2     2    2924         4.402179
2       2     3    1939         4.380564
3       2     4    1945         4.358058
4       2     5     858         4.341724
[DEBUG] Number of candidate items: 108
[DEBUG] Sample candidate items: ['549', '2924', '1939', '1945', '858']
[DEBUG] predicted_ratings_top_n shape: (613, 108)
[DEBUG] Non-zero entries: 30650
[DEBUG] Max predicted rating: 5.737256786033441
Missing items: {'32031', '8827', '1615', '78041', '2989', '2009', '5060', '7216', '69784', '3681', '4566', '26810', '26712', '697', '64983', '2440', '299', '79553', '928', '44694', '314', '2787', '592', '96821', '4369', '72733', '2259', '442', '2038', '2322', '3489', '213', '18', '215', '508', '8966', '4823', '2395', '1277', '5483', '288', '3397', '1683', '52885', '4614', '338', '597', '5991', '541', '260', '1249', '364', '1884', '1667', '2', '4837', '3173', '1282', '1269', '932', '3598', '2668', '671', '1499', '1049', '300', '3176', '1580', '2978', '8363', '670', '2099', '54001', '3178', '59', '1924', '2018', '1271', '540', '407', '4482', '154', '1907', '150', '2979', '5056', '596', '948', '377', '471', '58306', '8195', '4519', '47518', '2605', '1387', '236', '1629', '694', '3701', '929', '1918', '45186', '949', '262', '3515', '3114', '714', '45726', '71520', '30', '2287', '1997', '1965', '436', '2261', '26614', '640', '105', '265', '661', '41566', '1059', '89774', '3118', '2324', '2574', '15', '879', '1875', '2166', '1690', '390', '2749', '2013', '2071', '4441', '34334', '2882', '2084', '833', '25', '1885', '1944', '2262', '2687', '7451', '1834', '85788', '2817', '5956', '1927', '2109', '609', '553', '2034', '1427', '31685', '1833', '1726', '2044', '3937', '633', '2502', '509', '920', '2085', '798', '1947', '2291', '393', '8665', '1162', '3034', '53129', '4464', '1389', '216', '114060', '256', '586', '936', '711', '848', '1497', '80241', '2080', '5833', '180', '6473', '1920', '593', '2788', '2014', '64', '4105', '2022', '437', '85', '1124', '49396', '132', '1835', '1278', '2334', '1809', '1586', '82', '41569', '1958', '186', '316', '293', '5780', '613', '3074', '247', '1090', '173', '2789', '46976', '158', '842', '1721', '458', '1103', '8373', '33166', '2043', '6466', '6620', '1732', '2094', '3526', '4148', '70', '4641', '74458', '33660', '3004', '8337', '2111', '1892', '45722', '1995', '2107', '327', '5', '2890', '2010', '627', '81', '89', '2371', '241', '2003', '74946', '1611', '1702', '74510', '7980', '6373', '824', '5064', '8008', '6641', '2011', '3033', '1023', '909', '48385', '25753', '3547', '429', '892', '2640', '832', '1610', '68954', '74944', '4291', '46335', '4279', '110', '4886', '4191', '1887', '805', '277', '8984', '917', '55765', '1594', '2779', '2110', '455', '56801', '5061', '4011', '2269', '276', '122924', '502', '2140', '171', '5066', '4975', '62999', '253', '3081', '539', '2142', '902', '193', '2135', '523', '16', '332', '84944', '1487', '3061', '55', '4951', '169', '40819', '30793', '2912', '1648', '4111', '388', '8908', '986', '1245', '2006', '6440', '1909', '1051', '2005', '1422', '1865', '3418', '4234', '1841', '2082', '7347', '2118', '27674', '4520', '3549', '2699', '4974', '3527', '2122', '239', '630', '4889', '36529', '1722', '112460', '1950', '1541', '616', '80831', '2097', '1247', '2087', '3063', '207', '21', '249', '4351', '2046', '2988', '1416', '1552', '14', '36401', '261', '1940', '348', '2753', '94466', '8016', '1999', '53883', '1589', '3512', '1627', '331', '431', '165', '102', '457', '107406', '2294', '40815', '289', '2266', '1788', '5048', '2105', '804', '3980', '84187', '4247', '272', '95', '1676', '1284', '3698', '911', '1701', '55721', '4701', '2671', '8584', '1244', '1089', '177', '4255', '1917', '266', '976', '1792', '185', '2959', '319', '1873', '647', '2333', '421', '1991', '1619', '140174', '780', '218', '919', '490', '4254', '4043', '4546', '595', '3101', '2639', '42734', '84152', '1644', '123', '590', '160', '425', '26680', '1363', '40629', '334', '3396', '3175', '231', '454', '2577', '2616', '1645', '2769', '2108', '1911', '252', '2028', '5051', '742', '1587', '61123', '1375', '494', '2020', '1836', '653', '2516', '26258', '482', '942', '1923', '3638', '2348', '2761', '415', '26133', '46967', '8873', '489', '3117', '39183', '44004', '164', '3577', '2617', '74545', '38061', '25771', '2151', '8970', '4643', '2193', '7090', '1957', '1863', '2297', '112', '543', '1393', '42002', '831', '440', '2470', '612', '1688', '1088', '2752', '135', '4956', '267', '88744', '3786', '86320', '838', '31116', '587', '53435', '585', '1678', '2900', '5902', '88812', '4978', '759', '8129', '71254', '2015', '4443', '648', '101362', '254', '950', '37380', '1894', '988', '4896', '4979', '342', '1713', '4516', '6283', '786', '31522', '1949', '161', '81847', '802', '8973', '849', '2613', '2313', '4031', '24', '6593', '115210', '2078', '11', '497', '614', '2263', '83613', '4887', '2370', '2133', '67087', '1378', '43919', '3529', '4474', '8951', '2054', '2104', '6003', '1213', '2143', '58', '562', '2089', '1251', '49530', '687', '628', '2657', '778', '900', '452', '2033', '5881', '938', '4727', '74', '58559', '3083', '86', '1413', '2770', '818', '6970', '2252', '2428', '79', '428', '1785', '4880', '522', '2976', '2463', '1127', '1583', '507', '1608', '982', '1370', '881', '809', '53519', '931', '2728', '74948', '8833', '69406', '2123', '41571', '765', '6609', '99', '2610', '4638', '3051', '3168', '78088', '799', '3766', '56949', '340', '1978', '3210', '762', '2335', '2926', '275', '1391', '1735', '465', '2160', '312', '5927', '2734', '54272', '46578', '667', '280', '492', '225', '3479', '4977', '5481', '5686', '650', '2701', '4133', '861', '424', '63876', '90374', '8366', '25868', '2527', '6957', '36519', '8948', '466', '3057', '71282', '8464', '322', '426', '6537', '836', '1777', '606', '1591', '2232', '32444', '1951', '7454', '6538', '552', '107', '195', '2861', '1888', '866', '1729', '4012', '2759', '345', '2383', '2642', '3052', '378', '547', '1956', '558', '2125', '3082', '2100', '27721', '1374', '303', '1259', '5680', '783', '26776', '1639', '4928', '2575', '551', '1959', '1573', '460', '870', '1631', '4327', '2162', '2017', '3699', '8987', '204', '5961', '1441', '5608', '6934', '897', '1734', '8968', '955', '39446', '47099', '4480', '2567', '2860', '2048', '2012', '51540', '1921', '2528', '1024', '2116', '761', '594', '1772', '3556', '410', '84601', '1620', '248', '6078', '4816', '4658', '1694', '1779', '223', '6058', '467', '500', '1635', '4232', '153', '79224', '1858', '3483', '93855', '333', '4734', '1687', '381', '64499', '1265', '2349', '451', '347', '5247', '513', '1562', '329', '841', '3578', '837', '3011', '46972', '40826', '2457', '3103', '77561', '4034', '1994', '5187', '1566', '1584', '6643', '708', '172', '5816', '203', '839', '441', '3110', '1941', '26', '19', '315', '673', '8874', '62', '2002', '3079', '5121', '2058', '3179', '3146', '4709', '2115', '32029', '788', '3', '5319', '1599', '4025', '170', '423', '4992', '88', '1590', '531', '89492', '2841', '4990', '1581', '380', '7234', '1266', '2112', '1665', '588', '2805', '350', '1535', '599', '544', '3097', '2139', '53000', '3511', '8617', '1588', '1848', '1672', '5620', '3536', '1479', '339', '63540', '1373', '1544', '1996', '344', '6961', '1964', '33495', '81229', '235', '196', '3053', '2966', '101', '8860', '1680', '6936', '434', '85414', '3543', '3160', '59333', '168', '2069', '3763', '1882', '3016', '1407', '1641', '1895', '227', '1730', '1961', '8014', '4995', '784', '1593', '4723', '2239', '198', '2144', '3090', '480', '1073', '1616', '709', '1366', '2892', '4970', '3565', '2722', '1992', '5729', '2004', '2501', '504', '104', '8981', '7445', '1268', '1018', '1419', '2771', '2155', '1966', '2268', '1440', '1394', '8985', '914', '6436', '25750', '1380', '5147', '535', '6552', '2153', '4552', '830', '111759', '4344', '4676', '5139', '2433', '1673', '2565', '550', '1717', '2095', '8371', '8011', '63859', '427', '1372', '1092', '3635', '54503', '1807', '3177', '36527', '2067', '1246', '31696', '94959', '1396', '537', '2171', '3594', '1414', '2001', '1371', '2762', '546', '1597', '1093', '175', '7300', '2459', '468', '435', '4228', '2355', '8645', '691', '2469', '73', '2000', '86332', '6', '6947', '2288', '3581', '1954', '1272', '259', '532', '605', '1091', '30707', '44191', '2114', '1273', '57353', '1285', '8810', '1985', '43936', '810', '1125', '1429', '2436', '575', '4587', '8194', '524', '2321', '2134', '224', '47610', '349', '42011', '1257', '1376', '383', '65', '145', '2148', '910', '4703', '39414', '8368', '1975', '31410', '1377', '17', '317', '2253', '800', '5528', '2088', '2312', '1262', '3060', '1369', '47721', '45431', '2059', '292', '219', '79008', '891', '2993', '2455', '6535', '510', '1653', '1831', '26842', '32582', '806', '144', '12', '379', '1968', '481', '94478', '38304', '2447', '93840', '222', '155', '20', '1488', '4857', '1783', '27706', '35957', '26111', '2694', '2117', '44022', '924', '1791', '141', '1367', '56152', '678', '668', '97938', '1967', '1556', '50189', '2791', '6978', '42632', '662', '337', '2255', '1485', '2124', '2748', '1682', '22', '62956', '2662', '2539', '1633', '2161', '4958', '2302', '5899', '635', '59387', '8961', '65188', '2141', '163', '2282', '1405', '637', '1636', '1358'}
MF test predictions saved to: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_15-20-10/mf_test_100000_predictions.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_15-20-10/mmr_test_100000_cosine_top_50.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_15-20-10/mmr_test_100000_jaccard_top_50.csv
Pipeline for movies test finished successfully!
