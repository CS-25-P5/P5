Running on ailab-l4-10
Start time: Wed Dec 17 11:39:13 CET 2025
Activating virtual environment...
Python path: /ceph/home/student.aau.dk/vo55zp/projects/P5/venv/bin/python3
Python version: Python 3.10.12
Running on ailab-l4-10
Start time: Wed Dec 17 11:39:13 CET 2025
Starting pipeline...

=== Running pipeline with weights: relevance=0.5, diversity=0.5 ===
Starting pipeline for movies train
Train matrix: (671, 1242), Val matrix: (610, 1242)
Best (alpha, lambda) from Stage 1: {'alpha': 0.005, 'lambda_': 0.1}, RMSE=1.0547
Best k from Stage 2: 40, RMSE=1.0517
Best MF params: {'alpha': 0.005, 'lambda_': 0.1, 'k': 40}, RMSE=1.0517
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.45 with score 0.7202
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.30000000000000004 with score 0.6918
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mf_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-17_11-39-46/mf_train_100000_loss_history.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Pipeline for movies train finished successfully!
Start movies test pipeline 
[DEBUG] Filtered users: 613
[DEBUG] Filtered items: 1242
[DEBUG] Sample users: [2, 3, 4, 5, 6]
[DEBUG] Sample items: ['101', '101362', '1018', '102', '1023']
[DEBUG] Predicted ratings shape: (613, 1242)
[DEBUG] Min/max predicted rating: 0.6149601894622856/6.008548057556934
predicted_ratings.shape: (613, 1242)
R_filtered.shape: (613, 1178)
MF predictions saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-17_11-39-46/mf_test_100000_top_50.csv
[DEBUG] Top-N CSV rows: 30650
[DEBUG] Unique users in CSV: 613
[DEBUG] Unique items in CSV: 218
[DEBUG] Sample rows:
   userId  rank  itemId  predictedRating
0       2     1    1939         4.502959
1       2     2    2924         4.498782
2       2     3     318         4.454299
3       2     4    3088         4.398648
4       2     5     858         4.383827
[DEBUG] Number of candidate items: 218
[DEBUG] Sample candidate items: ['1939', '2924', '318', '3088', '858']
[DEBUG] predicted_ratings_top_n shape: (613, 218)
[DEBUG] Non-zero entries: 30650
[DEBUG] Max predicted rating: 6.008548057556934
Missing items: {'2253', '338', '8617', '164', '553', '2142', '55765', '500', '2044', '648', '2255', '1266', '253', '3937', '2335', '144', '1927', '219', '2095', '2988', '460', '45186', '83613', '33660', '300', '3763', '1583', '63540', '43919', '1162', '4951', '2759', '275', '2038', '507', '4546', '909', '3397', '2447', '1957', '640', '1633', '2151', '4480', '2322', '2457', '55721', '2321', '2005', '50189', '216', '63859', '3097', '314', '5956', '3168', '1590', '1591', '1683', '455', '1378', '2567', '84601', '4887', '2297', '135', '173', '33495', '72733', '932', '612', '46972', '694', '4025', '101', '1103', '1049', '104', '5899', '7980', '1676', '628', '2459', '714', '112', '2312', '3176', '1951', '6436', '2109', '4255', '95', '39446', '239', '1552', '107', '424', '67087', '902', '3101', '2134', '3547', '585', '2012', '2059', '441', '2123', '1485', '3681', '26776', '1701', '3581', '4031', '42011', '2263', '5620', '20', '39414', '2734', '1956', '276', '948', '145', '2111', '364', '4614', '8981', '2701', '6058', '471', '1631', '2640', '55', '818', '2125', '691', '1772', '1975', '6957', '6538', '2333', '112460', '836', '252', '3178', '4520', '84187', '12', '1949', '2616', '349', '2082', '4516', '4734', '39183', '1629', '4727', '2011', '5139', '115210', '45431', '280', '1366', '3418', '4482', '393', '810', '171', '62999', '31410', '26680', '1608', '2080', '1573', '53000', '204', '1996', '2502', '277', '627', '111759', '426', '2805', '780', '1271', '1809', '662', '3053', '169', '267', '1785', '2882', '259', '8985', '544', '79008', '288', '3536', '107406', '1588', '2617', '2001', '5048', '6934', '2752', '32029', '2912', '32444', '1978', '65188', '8833', '46967', '177', '435', '7454', '41571', '4464', '383', '53129', '25868', '798', '5729', '1088', '2455', '38304', '4254', '5', '6970', '1858', '102', '1788', '661', '241', '2282', '1918', '407', '1639', '94478', '8968', '1497', '2069', '4232', '1268', '1372', '1391', '2108', '80241', '2613', '2259', '41566', '1873', '5686', '1636', '434', '27706', '8366', '6473', '1882', '316', '2287', '158', '595', '2015', '3511', '2748', '348', '342', '123', '510', '5061', '1393', '762', '1427', '841', '3635', '54272', '24', '303', '4676', '3527', '2139', '709', '842', '3081', '56801', '2639', '451', '1678', '458', '1073', '1127', '8373', '3638', '69406', '630', '26842', '34334', '552', '4587', '1023', '3082', '2100', '540', '2789', '3', '509', '2078', '3396', '266', '1848', '2104', '248', '36519', '1875', '466', '436', '53435', '2469', '697', '79553', '74944', '891', '1377', '4823', '26', '8363', '381', '4519', '1887', '1093', '1124', '2018', '468', '2699', '2002', '7216', '575', '2900', '26810', '122924', '378', '423', '1090', '2516', '225', '2575', '543', '2107', '1487', '84152', '2269', '180', '4816', '5483', '4369', '837', '25771', '80831', '15', '2161', '388', '2088', '40826', '47099', '1387', '2003', '546', '4344', '8645', '2046', '2470', '1371', '635', '670', '5881', '36527', '31685', '1479', '2978', '265', '3526', '1374', '3103', '480', '1954', '547', '614', '2143', '1245', '1541', '1995', '2370', '163', '4886', '1777', '2115', '35957', '3016', '8194', '452', '74', '539', '88744', '8014', '56949', '1680', '2436', '2989', '3033', '32031', '1440', '89774', '54001', '2114', '36401', '1735', '6643', '2687', '168', '5816', '344', '21', '4889', '1991', '22', '1059', '2349', '86332', '2334', '2089', '333', '30793', '8008', '1865', '8987', '1566', '881', '4701', '986', '64499', '74510', '4723', '5064', '1620', '2141', '63876', '3079', '489', '4857', '5481', '1894', '5528', '1923', '490', '377', '25750', '609', '502', '711', '1909', '1807', '2527', '93840', '5060', '4351', '1405', '742', '3061', '89', '4990', '82', '2668', '4441', '59', '6593', '1831', '198', '31522', '49530', '37380', '8195', '1587', '8908', '2926', '3177', '1667', '497', '3210', '8129', '2239', '380', '1694', '442', '1367', '3090', '928', '8973', '3057', '4703', '917', '1729', '6', '64983', '339', '32582', '45726', '550', '1841', '261', '2022', '2171', '2993', '2117', '25753', '5066', '1641', '647', '431', '2155', '4474', '57353', '289', '839', '1967', '633', '2071', '7347', '2', '4327', '1422', '637', '2671', '114060', '765', '3529', '26258', '6078', '4148', '3118', '2034', '215', '588', '5991', '3512', '2006', '678', '2841', '805', '761', '4247', '1369', '2014', '81847', '2605', '19', '848', '2440', '4958', '482', '2642', '160', '1713', '2528', '2009', '467', '900', '46335', '1997', '14', '1950', '1627', '8016', '2266', '334', '708', '897', '88', '1544', '6961', '2890', '231', '1125', '195', '481', '7451', '2110', '2291', '218', '2148', '2017', '3052', '4970', '531', '2054', '6978', '62956', '47721', '81', '1586', '1721', '42632', '56152', '88812', '1959', '2262', '1246', '988', '256', '4975', '2122', '11', '1994', '74948', '1373', '2118', '8948', '312', '8464', '4191', '4956', '44022', '4552', '668', '1688', '1779', '1277', '2979', '132', '1941', '1863', '1653', '616', '329', '6373', '70', '1940', '2728', '90374', '2892', '2383', '2749', '2004', '1665', '8368', '53519', '165', '1092', '532', '3063', '4977', '2000', '804', '71254', '1380', '79224', '196', '1888', '4837', '6535', '172', '2348', '161', '914', '224', '155', '2193', '207', '1690', '1895', '6466', '154', '590', '938', '1884', '2753', '16', '2261', '1722', '45722', '1645', '1535', '2610', '262', '1499', '2288', '3179', '1589', '1273', '6620', '1051', '4658', '596', '1944', '8810', '41569', '6283', '61123', '3980', '6947', '2094', '4641', '1892', '982', '2860', '78088', '47610', '4105', '44004', '8860', '3489', '2135', '4566', '667', '26111', '322', '429', '8873', '1615', '2574', '3117', '4896', '3051', '48385', '8665', '2232', '650', '3004', '831', '1285', '8951', '586', '31696', '3173', '929', '833', '249', '2084', '4974', '522', '74946', '59333', '3698', '30707', '1702', '861', '2779', '332', '465', '2058', '86320', '93855', '784', '879', '1419', '54503', '36529', '1985', '4979', '1730', '949', '1648', '5780', '799', '1389', '587', '2722', '8584', '74458', '4012', '1413', '2428', '2771', '415', '687', '3479', '105', '2268', '3699', '1375', '523', '1717', '2657', '2153', '2787', '317', '558', '42002', '830', '2105', '809', '2565', '59387', '504', '30', '1257', '227', '3114', '26133', '1921', '537', '1580', '27674', '1833', '653', '2112', '222', '1687', '5680', '1251', '8966', '4643', '4638', '1992', '492', '1999', '2144', '1416', '2033', '4443', '1619', '976', '783', '2124', '2116', '4111', '42734', '2133', '1597', '1682', '292', '3577', '2085', '2013', '3598', '2087', '2355', '153', '440', '8984', '410', '4291', '1783', '1370', '74545', '2166', '78041', '44694', '65', '1917', '3594', '788', '97938', '4279', '3146', '870', '1024', '425', '4978', '1792', '347', '5051', '2976', '3556', '327', '437', '1265', '1441', '1610', '1644', '824', '43936', '1018', '193', '597', '6537', '1835', '77561', '3549', '7300', '3786', '849', '1282', '379', '931', '936', '3701', '3483', '1726', '6936', '186', '1394', '1911', '2043', '1593', '254', '99', '4992', '3034', '613', '2048', '1611', '2662', '427', '140174', '802', '4228', '494', '1488', '62', '1396', '4043', '5247', '68954', '1920', '79', '3766', '5961', '2371', '1376', '64', '5927', '1616', '524', '213', '340', '2463', '457', '1581', '236', '40819', '8371', '1924', '2067', '1836', '513', '18', '592', '25', '1091', '6552', '2966', '2252', '71282', '1958', '806', '185', '31116', '345', '2097', '454', '8011', '101362', '203', '3565', '1363', '1594', '2770', '1599', '85788', '141', '1907', '2433', '3060', '5187', '4709', '94466', '606', '331', '390', '150', '69784', '605', '315', '49396', '3011', '2694', '4234', '7234', '832', '2162', '1966', '4034', '2302', '2539', '1964', '3110', '71520', '58306', '2861', '86', '1556', '2140', '759', '84944', '673', '508', '170', '5056', '1791', '27721', '6609', '2577', '1562', '1584', '2294', '7445', '421', '1965', '3515', '350', '1672', '892', '5833', '2769', '2099', '4928', '6003', '942', '428', '551', '2817', '786', '1414', '3074'}
MF test predictions saved to: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-17_11-39-46/mf_test_100000_predictions.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-17_11-39-46/mmr_test_100000_cosine_top_50.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-17_11-39-46/mmr_test_100000_jaccard_top_50.csv
Pipeline for movies test finished successfully!
