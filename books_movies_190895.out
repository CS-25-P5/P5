Running on ailab-l4-07
Start time: Tue Dec 16 00:46:04 CET 2025
Activating virtual environment...
Python path: /ceph/home/student.aau.dk/vo55zp/projects/P5/venv/bin/python3
Python version: Python 3.10.12
Running on ailab-l4-07
Start time: Tue Dec 16 00:46:04 CET 2025
Starting pipeline...

=== Running pipeline with weights: relevance=0.5, diversity=0.5 ===
Starting pipeline for movies train
Train matrix: (671, 1242), Val matrix: (610, 1242)
Best MF params: {'k': 60, 'alpha': 0.005, 'lambda_': 0.2}, RMSE=1.0411
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6502
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6564
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mf_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_00-46-40/mf_train_100000_loss_history.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Pipeline for movies train finished successfully!
Start movies test pipeline 
[DEBUG] Filtered users: 613
[DEBUG] Filtered items: 868
[DEBUG] Sample users: [2, 3, 4, 5, 6]
[DEBUG] Sample items: ['101', '102', '104', '1049', '105']
[DEBUG] Predicted ratings shape: (613, 868)
[DEBUG] Min/max predicted rating: 0.8305390614491499/5.705492834516667
MF predictions saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_00-46-40/mf_test_100000_top_50.csv
[DEBUG] Top-N CSV rows: 30650
[DEBUG] Unique users in CSV: 613
[DEBUG] Unique items in CSV: 92
[DEBUG] Sample rows:
   userId  rank  itemId  predictedRating
0       2     1     549         4.414122
1       2     2    1945         4.358058
2       2     3     858         4.341724
3       2     4     318         4.337373
4       2     5     905         4.319272
[DEBUG] Number of candidate items: 92
[DEBUG] Sample candidate items: ['549', '1945', '858', '318', '905']
[DEBUG] predicted_ratings_top_n shape: (613, 92)
[DEBUG] Non-zero entries: 30650
[DEBUG] Max predicted rating: 5.705492834516667
Missing items: {'101', '612', '2282', '2567', '45722', '8011', '303', '224', '531', '84601', '1393', '2463', '2616', '804', '2082', '832', '2912', '344', '588', '2321', '55721', '849', '79553', '1732', '3101', '2989', '2805', '6936', '909', '1127', '1573', '1272', '160', '2787', '3418', '3011', '348', '88744', '914', '2009', '6', '135', '480', '1831', '1262', '2436', '14', '2334', '2860', '26712', '5060', '942', '837', '7445', '3698', '429', '5066', '19', '180', '2115', '2371', '2433', '8014', '42011', '45186', '5481', '3396', '18', '1688', '932', '778', '186', '4734', '2959', '3565', '1791', '2527', '2662', '85788', '3210', '8665', '84187', '25750', '492', '40819', '3146', '540', '590', '277', '1591', '381', '95', '331', '3489', '2302', '1479', '2841', '84944', '44191', '342', '1284', '316', '4344', '524', '2335', '4012', '678', '3980', '798', '6003', '1269', '5686', '2261', '2151', '1049', '7980', '1544', '204', '2759', '4889', '1921', '2094', '2253', '26133', '155', '1911', '256', '586', '762', '8973', '900', '1611', '1581', '2001', '1586', '59333', '711', '2099', '88', '1834', '64', '68954', '8873', '3578', '765', '2687', '317', '198', '1414', '2288', '4816', '1375', '2988', '39183', '6058', '2324', '8366', '12', '982', '21', '2000', '551', '2161', '74510', '1788', '5247', '673', '2447', '2018', '427', '497', '2640', '3526', '1633', '436', '1954', '4701', '471', '53519', '609', '7090', '1997', '594', '613', '30793', '8874', '165', '1251', '1964', '89492', '52885', '3097', '661', '4958', '532', '839', '2762', '2269', '2124', '2006', '1407', '2978', '1909', '5902', '1923', '1858', '338', '1124', '2141', '2734', '1162', '1947', '441', '4641', '5121', '83613', '253', '2232', '8984', '1895', '546', '44694', '1389', '2134', '2108', '891', '62999', '4723', '265', '2112', '288', '44022', '592', '6373', '2002', '2349', '4441', '4643', '481', '1884', '552', '2993', '2004', '2105', '830', '1994', '2502', '2966', '7451', '7454', '140174', '3176', '2058', '1358', '47610', '58', '36401', '33166', '440', '805', '8961', '2694', '215', '1266', '1835', '3034', '1257', '105', '1958', '266', '5991', '2770', '3581', '2528', '8966', '468', '3160', '2291', '2699', '605', '8368', '2110', '2013', '231', '173', '1610', '2160', '16', '6934', '276', '1975', '806', '628', '2861', '222', '691', '1271', '1092', '1690', '1091', '3483', '193', '53129', '47099', '378', '522', '1597', '25', '3168', '2033', '314', '1125', '1589', '8985', '2266', '3117', '2297', '332', '553', '1374', '383', '249', '562', '8464', '8833', '1387', '380', '4191', '161', '2565', '141', '163', '1653', '82', '2100', '3052', '2109', '482', '5061', '3594', '2791', '2', '2069', '1639', '1645', '8810', '3512', '5147', '1380', '1103', '4977', '541', '1580', '415', '327', '4979', '22', '4232', '920', '1687', '410', '48385', '1950', '2012', '2022', '2122', '53000', '539', '54001', '79', '168', '949', '784', '1717', '1373', '917', '1485', '145', '1721', '97938', '2085', '2080', '910', '1378', '2395', '1785', '3699', '500', '93840', '2005', '2046', '2089', '2067', '1088', '223', '31410', '1615', '4975', '558', '2123', '169', '272', '454', '1729', '58306', '50189', '1562', '2087', '595', '653', '5', '4351', '502', '236', '1875', '1594', '919', '455', '1566', '1608', '783', '112', '1416', '2539', '6643', '3051', '457', '866', '838', '4254', '51540', '379', '879', '2470', '550', '1244', '442', '70', '2078', '1487', '8645', '1917', '2140', '6535', '509', '55', '1396', '6436', '337', '1391', '5620', '423', '1713', '1968', '1370', '8970', '85414', '1673', '1584', '2779', '1885', '2457', '627', '3', '1949', '4886', '5881', '1372', '59387', '44004', '3060', '4638', '1961', '616', '334', '1367', '46578', '36519', '466', '45431', '3053', '3536', '1552', '2193', '671', '8371', '6620', '1405', '24', '107406', '1734', '280', '1894', '3016', '3114', '319', '111759', '3061', '27721', '4880', '1918', '1371', '49530', '153', '2333', '260', '597', '955', '3178', '986', '1282', '2383', '158', '1772', '1619', '252', '4148', '428', '300', '54503', '2017', '2617', '213', '3083', '63859', '3082', '647', '1777', '2671', '3173', '2428', '648', '1641', '2642', '329', '6537', '1682', '1887', '46972', '1779', '2111', '2011', '1247', '333', '5528', '81', '2926', '1488', '1959', '2114', '788', '123', '435', '1809', '1967', '2038', '2459', '786', '494', '523', '1587', '235', '1377', '40815', '6593', '1722', '74458', '1836', '293', '1882', '2263', '195', '434', '4896', '4857', '364', '3081', '31696', '1376', '17', '1701', '1394', '2252', '340', '5680', '4247', '780', '2728', '377', '809', '596', '339', '4823', '2059', '2144', '4369', '47518', '841', '2003', '4255', '225', '65', '452', '585', '2054', '2239', '6978', '1995', '587', '1285', '1792', '1907', '350', '800', '1259', '86332', '262', '315', '349', '3577', '924', '1556', '36529', '2118', '3549', '239', '1093', '4228', '2034', '172', '902', '345', '662', '15', '104', '38061', '2116', '46976', '81229', '593', '196', '64983', '1726', '227', '1678', '5816', '6947', '1588', '861', '2313', '3090', '1680', '2014', '543', '185', '40629', '2028', '144', '261', '11', '102', '2749', '637', '2294', '81847', '20', '3701', '1499', '2088', '4031', '2268', '170', '107', '177', '2348', '802', '4025', '3175', '1985', '30707', '1944', '2701', '74946', '36527', '2355', '928', '2605', '3556', '1590', '62', '708', '1249', '5064', '2139', '247', '3033', '54272', '1991', '2143', '1956', '1265', '4974', '2125', '39446', '640', '5608', '4995', '3397', '1702', '2135', '3763', '3479', '2722', '1278', '1992', '5956', '41566', '4034', '1366', '2153', '2657', '2262', '1957', '1090', '31685', '6440', '2312', '207', '241', '2890', '8981', '2010', '3004', '1951', '2761', '799', '150', '110', '1213', '1888', '2455', '1892', '3638', '55765', '5483', '3635', '4011', '1593', '4970', '1073', '1676', '6283', '513', '6552', '89', '77561', '714', '535', '1833', '2084', '33660', '1246', '3527', '292', '2142', '431', '508', '94959', '950', '2166', '2015', '4709', '1059', '216', '78088', '6957'}
MF test predictions saved to: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_00-46-40/mf_test_100000_predictions.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_00-46-40/mmr_test_100000_cosine_top_50.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_00-46-40/mmr_test_100000_jaccard_top_50.csv
Pipeline for movies test finished successfully!
