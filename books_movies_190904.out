Running on ailab-l4-01
Start time: Tue Dec 16 02:14:00 CET 2025
Activating virtual environment...
Python path: /ceph/home/student.aau.dk/vo55zp/projects/P5/venv/bin/python3
Python version: Python 3.10.12
Running on ailab-l4-01
Start time: Tue Dec 16 02:14:00 CET 2025
Starting pipeline...

=== Running pipeline with weights: relevance=0.5, diversity=0.5 ===
Starting pipeline for movies train
Train matrix: (671, 1242), Val matrix: (610, 1242)
Best MF params: {'k': 60, 'alpha': 0.005, 'lambda_': 0.2}, RMSE=1.0411
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6502
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6564
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mf_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_02-14-02/mf_train_100000_loss_history.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Pipeline for movies train finished successfully!
Start movies test pipeline 
[DEBUG] Filtered users: 613
[DEBUG] Filtered items: 868
[DEBUG] Sample users: [2, 3, 4, 5, 6]
[DEBUG] Sample items: ['101', '102', '104', '1049', '105']
[DEBUG] Predicted ratings shape: (613, 868)
[DEBUG] Min/max predicted rating: 0.8305390614491499/5.705492834516667
MF predictions saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_02-14-02/mf_test_100000_top_50.csv
[DEBUG] Top-N CSV rows: 30650
[DEBUG] Unique users in CSV: 613
[DEBUG] Unique items in CSV: 92
[DEBUG] Sample rows:
   userId  rank  itemId  predictedRating
0       2     1     549         4.414122
1       2     2    1945         4.358058
2       2     3     858         4.341724
3       2     4     318         4.337373
4       2     5     905         4.319272
[DEBUG] Number of candidate items: 92
[DEBUG] Sample candidate items: ['549', '1945', '858', '318', '905']
[DEBUG] predicted_ratings_top_n shape: (613, 92)
[DEBUG] Non-zero entries: 30650
[DEBUG] Max predicted rating: 5.705492834516667
Missing items: {'788', '1591', '44004', '8665', '799', '1278', '2010', '8874', '1588', '2015', '1372', '49530', '5061', '1639', '110', '2966', '562', '711', '4441', '1271', '6643', '102', '1676', '300', '1611', '1619', '2334', '2005', '163', '1958', '2349', '315', '2003', '1587', '678', '314', '383', '79553', '2470', '2759', '89', '900', '277', '1680', '58', '3489', '2253', '2890', '1994', '47518', '53129', '2335', '3527', '15', '1833', '1959', '4857', '586', '2014', '44022', '2022', '2028', '337', '4979', '6552', '20', '170', '53519', '609', '2139', '123', '225', '2657', '380', '837', '63859', '150', '161', '3097', '2282', '1124', '2565', '4247', '593', '168', '471', '262', '1610', '2841', '5608', '1244', '1885', '26133', '2143', '3549', '1265', '2011', '249', '891', '468', '648', '832', '2428', '1544', '6058', '4886', '5620', '1967', '914', '2770', '2978', '1831', '241', '410', '252', '46972', '1917', '585', '6620', '6957', '2324', '3175', '1376', '339', '2734', '93840', '1088', '2288', '2294', '2527', '4232', '97938', '2193', '2089', '381', '4995', '4369', '2069', '185', '27721', '6440', '866', '429', '145', '4977', '522', '3210', '4638', '2455', '2109', '2457', '1894', '223', '798', '231', '36519', '1777', '216', '3083', '2371', '1713', '455', '1247', '30707', '5528', '3160', '47099', '2268', '58306', '1721', '6003', '778', '105', '1968', '762', '41566', '276', '2067', '4816', '2094', '1259', '3053', '6535', '2791', '800', '920', '596', '40815', '550', '917', '349', '1597', '2436', '4975', '3011', '48385', '457', '2116', '85414', '3081', '107406', '12', '2115', '256', '59387', '982', '342', '616', '2059', '1882', '5121', '1734', '2142', '2291', '155', '1213', '1373', '2', '2002', '2135', '3051', '1788', '3004', '4701', '6373', '33166', '14', '513', '81', '186', '1092', '303', '949', '1284', '2605', '1997', '4889', '5483', '2861', '293', '492', '2018', '2232', '2006', '17', '1772', '2355', '2297', '1923', '1678', '4011', '480', '1073', '2085', '2699', '5', '8014', '94959', '1593', '1836', '1566', '2459', '84944', '928', '541', '316', '2959', '19', '4034', '587', '59333', '1393', '265', '195', '661', '2100', '1366', '1266', '1951', '334', '543', '3556', '2004', '345', '1954', '247', '1688', '64', '85788', '2033', '50189', '497', '531', '1396', '809', '509', '986', '783', '165', '40629', '838', '441', '532', '2013', '1125', '54001', '1892', '494', '2433', '1835', '5066', '144', '2694', '5060', '1269', '2166', '932', '662', '8984', '153', '1371', '830', '1556', '45186', '88', '1162', '1370', '535', '68954', '3701', '2502', '605', '434', '1391', '6947', '3060', '3763', '481', '2239', '2124', '1809', '1416', '88744', '452', '1488', '1405', '427', '597', '180', '1956', '7090', '1246', '2261', '3173', '671', '18', '2084', '780', '2058', '950', '428', '588', '2313', '1909', '3578', '2161', '2687', '378', '691', '2122', '1729', '253', '344', '1921', '539', '1562', '765', '924', '2038', '40819', '805', '196', '1944', '319', '11', '637', '640', '2160', '36527', '879', '288', '177', '8371', '1907', '2722', '3698', '546', '2640', '2118', '4643', '54272', '3479', '4191', '81847', '540', '8985', '3', '1589', '784', '3397', '44191', '552', '558', '435', '8961', '2082', '2269', '4896', '1653', '1594', '33660', '81229', '628', '327', '5881', '2701', '1377', '2009', '4025', '839', '84187', '1682', '2012', '1641', '39446', '82', '193', '4148', '198', '4012', '39183', '4254', '3581', '31696', '6', '8873', '2993', '909', '4880', '78088', '1586', '6978', '112', '1722', '1701', '2302', '3176', '2078', '3396', '1726', '454', '508', '1779', '523', '423', '227', '3052', '5816', '317', '613', '1961', '215', '1911', '1590', '442', '1717', '3526', '2616', '524', '466', '31410', '2263', '8970', '2787', '8981', '3483', '348', '2080', '2151', '673', '1964', '1487', '45431', '4823', '107', '1389', '2034', '2321', '26712', '24', '1272', '1732', '1378', '350', '1407', '647', '51540', '3146', '6436', '2114', '3512', '1485', '47610', '377', '1633', '2912', '36529', '1995', '30793', '74510', '1615', '2266', '239', '910', '2860', '2749', '1884', '6283', '4709', '2988', '5247', '653', '8810', '4723', '3061', '942', '266', '553', '1059', '70', '62999', '364', '1834', '42011', '340', '502', '2447', '1584', '4031', '64983', '1552', '101', '1950', '95', '329', '2144', '802', '3635', '1687', '5686', '16', '2087', '7445', '204', '2141', '1581', '1127', '3418', '1358', '500', '4228', '5902', '849', '786', '841', '902', '8011', '1394', '160', '2262', '2762', '551', '2567', '3016', '3638', '236', '1093', '804', '2662', '111759', '21', '36401', '5991', '207', '292', '2761', '104', '5956', '1957', '224', '4974', '55765', '173', '25750', '1785', '25', '8833', '1367', '52885', '3594', '4641', '46578', '45722', '2463', '54503', '8973', '4351', '1262', '86332', '2110', '2108', '1918', '2528', '6934', '8368', '2112', '2088', '1499', '612', '84601', '8366', '2153', '7980', '1090', '3034', '1374', '4970', '5064', '172', '2125', '2252', '1249', '331', '1285', '440', '6537', '8464', '1895', '1103', '333', '1702', '4958', '2312', '62', '2134', '2001', '919', '1375', '1875', '2671', '141', '89492', '482', '1949', '1858', '235', '2123', '3565', '79', '1380', '2989', '83613', '3178', '1690', '1282', '592', '38061', '3033', '1251', '158', '7451', '1792', '5680', '379', '2046', '4734', '2000', '2926', '1887', '140174', '272', '280', '2333', '4255', '44694', '1479', '1975', '3699', '3168', '1673', '2140', '2348', '261', '714', '74458', '1049', '3090', '415', '55', '3577', '2617', '74946', '2383', '55721', '436', '1947', '260', '7454', '222', '22', '3114', '1888', '2539', '627', '1257', '6936', '2017', '1991', '2805', '5481', '2728', '169', '135', '2779', '2395', '3536', '431', '2111', '8966', '46976', '1091', '8645', '1387', '1608', '594', '3101', '2105', '1992', '338', '1414', '1985', '2642', '65', '1791', '53000', '1580', '955', '6593', '708', '1573', '213', '3980', '590', '2054', '332', '3082', '77561', '806', '861', '5147', '595', '4344', '31685', '1645', '3117', '2099'}
MF test predictions saved to: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_02-14-02/mf_test_100000_predictions.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_02-14-02/mmr_test_100000_cosine_top_50.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_02-14-02/mmr_test_100000_jaccard_top_50.csv
Pipeline for movies test finished successfully!
