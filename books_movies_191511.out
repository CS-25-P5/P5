Running on ailab-l4-04
Start time: Tue Dec 16 15:44:05 CET 2025
Activating virtual environment...
Python path: /ceph/home/student.aau.dk/vo55zp/projects/P5/venv/bin/python3
Python version: Python 3.10.12
Running on ailab-l4-04
Start time: Tue Dec 16 15:44:05 CET 2025
Starting pipeline...

=== Running pipeline with weights: relevance=0.5, diversity=0.5 ===
Starting pipeline for movies train
Train matrix: (671, 1242), Val matrix: (610, 1242)
Best MF params: {'k': 60, 'alpha': 0.005, 'lambda_': 0.2}, RMSE=1.0411
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6483
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6539
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mf_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_15-44-39/mf_train_100000_loss_history.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Pipeline for movies train finished successfully!
Start movies test pipeline 
[DEBUG] Filtered users: 613
[DEBUG] Filtered items: 1242
[DEBUG] Sample users: [2, 3, 4, 5, 6]
[DEBUG] Sample items: ['101', '101362', '1018', '102', '1023']
[DEBUG] Predicted ratings shape: (613, 1242)
[DEBUG] Min/max predicted rating: 0.8305390614491499/5.737256786033441
predicted_ratings.shape: (613, 1242)
R_filtered.shape: (613, 1178)
MF predictions saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_15-44-39/mf_test_100000_top_50.csv
[DEBUG] Top-N CSV rows: 30650
[DEBUG] Unique users in CSV: 613
[DEBUG] Unique items in CSV: 108
[DEBUG] Sample rows:
   userId  rank  itemId  predictedRating
0       2     1     549         4.414122
1       2     2    2924         4.402179
2       2     3    1939         4.380564
3       2     4    1945         4.358058
4       2     5     858         4.341724
[DEBUG] Number of candidate items: 108
[DEBUG] Sample candidate items: ['549', '2924', '1939', '1945', '858']
[DEBUG] predicted_ratings_top_n shape: (613, 108)
[DEBUG] Non-zero entries: 30650
[DEBUG] Max predicted rating: 5.737256786033441
Missing items: {'2058', '441', '32031', '4025', '612', '1968', '902', '1593', '348', '1541', '708', '2038', '1372', '637', '4837', '2291', '1858', '1049', '2791', '2752', '1956', '8011', '59333', '2111', '5147', '6078', '33166', '1615', '44694', '936', '2753', '2861', '2048', '4978', '497', '831', '2455', '8129', '1678', '5319', '1124', '2141', '43919', '6593', '2001', '742', '609', '8860', '26', '1894', '5620', '2860', '415', '616', '711', '5902', '17', '550', '58306', '79', '424', '2502', '627', '914', '2033', '19', '5483', '2022', '8961', '31696', '1665', '21', '1213', '93840', '949', '1162', '1277', '1958', '2012', '2817', '4587', '5991', '27706', '504', '8366', '630', '68954', '1863', '54503', '2004', '1589', '1772', '3565', '2135', '471', '6436', '47721', '861', '2084', '218', '1246', '800', '1949', '4974', '163', '2516', '4638', '2370', '54272', '1717', '2104', '426', '1273', '2302', '85788', '3176', '2447', '339', '8985', '55', '932', '6961', '170', '30', '8337', '173', '115210', '4546', '1967', '1584', '5528', '2993', '247', '4896', '26133', '56152', '2734', '982', '2005', '431', '6609', '761', '6003', '319', '2321', '3033', '84944', '1371', '45431', '26810', '62', '1488', '1059', '62956', '2640', '344', '1389', '82', '5051', '1440', '3512', '2239', '222', '635', '2722', '1682', '839', '275', '97938', '96821', '42002', '2890', '64', '252', '436', '390', '4643', '3079', '51540', '42632', '1573', '14', '8373', '765', '5060', '1629', '455', '804', '293', '332', '2355', '1586', '1375', '169', '2259', '4105', '254', '423', '606', '2142', '378', '1730', '1377', '678', '509', '640', '81', '5780', '1895', '4956', '316', '2255', '1369', '7980', '3577', '1407', '160', '74944', '7234', '331', '2125', '7216', '1282', '6283', '1865', '783', '3074', '74545', '2067', '1089', '1373', '4676', '1673', '900', '266', '1917', '74948', '507', '2335', '41571', '427', '597', '1653', '2334', '2761', '1272', '4701', '78041', '2085', '988', '3090', '8016', '93855', '1257', '315', '1882', '6373', '986', '4566', '4520', '1635', '421', '2976', '56801', '596', '90374', '8008', '4279', '3699', '196', '849', '553', '788', '53883', '4995', '3052', '64499', '2094', '101', '2009', '3635', '2428', '3011', '46967', '6466', '8874', '3057', '41566', '1964', '3786', '261', '6957', '7347', '543', '1809', '69784', '2287', '425', '2014', '49396', '4889', '42734', '2348', '31410', '2263', '1702', '207', '1713', '6058', '314', '8014', '40629', '4614', '79553', '195', '39414', '2003', '778', '2133', '2539', '1284', '172', '8810', '1636', '955', '2266', '2282', '2020', '917', '2989', '3082', '235', '460', '575', '1992', '1024', '3581', '227', '1581', '2324', '1268', '3701', '2978', '6934', '842', '72733', '57353', '2148', '1885', '33660', '26712', '2294', '25', '79224', '870', '338', '364', '259', '213', '26842', '88744', '1051', '500', '3178', '2759', '5956', '428', '2616', '3479', '70', '508', '2082', '4232', '919', '3766', '2080', '3681', '2577', '881', '440', '225', '1125', '1271', '2155', '6936', '2069', '112', '1732', '350', '248', '288', '2115', '322', '53519', '55765', '327', '3536', '1485', '1688', '1641', '585', '377', '1266', '6473', '3146', '34334', '4254', '1608', '2574', '2162', '670', '2143', '3937', '1687', '4031', '780', '347', '3114', '32582', '1023', '1394', '340', '2124', '1278', '8194', '3118', '40815', '2979', '2010', '1380', '2269', '1374', '2232', '74510', '1726', '3483', '5899', '5187', '1393', '3110', '186', '1487', '1093', '2088', '8665', '661', '588', '1907', '2011', '2268', '1997', '379', '2028', '24', '1721', '2567', '6538', '2457', '1807', '3578', '929', '4516', '6', '161', '193', '380', '2789', '1127', '3549', '4291', '393', '2', '74', '535', '25753', '3397', '897', '8987', '4823', '3097', '1645', '46976', '26680', '8966', '1985', '2112', '1416', '2253', '5048', '6641', '6947', '107', '2046', '114060', '2089', '4441', '39183', '4111', '1610', '1588', '5121', '43936', '1701', '2087', '494', '47610', '3980', '342', '1875', '4344', '26776', '1735', '832', '44191', '249', '1683', '383', '1680', '4148', '171', '216', '866', '2469', '33495', '8371', '53129', '492', '2006', '49530', '44022', '86320', '153', '150', '329', '48385', '6978', '1966', '158', '2034', '1396', '2109', '5961', '532', '3638', '2171', '1387', '4880', '1441', '1918', '303', '458', '63859', '3547', '45722', '687', '818', '2639', '77561', '3160', '2044', '1619', '185', '2662', '2322', '46335', '2892', '2118', '1920', '590', '71282', '6537', '1991', '80831', '848', '2123', '2160', '36401', '2788', '799', '42011', '1599', '1848', '1285', '41569', '292', '931', '4474', '2116', '2261', '1779', '1497', '4351', '1611', '2565', '300', '3081', '47099', '40826', '552', '452', '6970', '265', '239', '1978', '2262', '1247', '26614', '12', '84152', '950', '8968', '593', '31685', '2095', '2153', '1676', '2779', '3051', '5927', '4480', '2966', '481', '2017', '2297', '63876', '1631', '2117', '1911', '802', '31116', '2349', '442', '1587', '3060', '26111', '2313', '5608', '909', '198', '1269', '2134', '3173', '5056', '22', '1367', '2139', '824', '135', '44004', '25750', '8833', '2528', '1391', '2694', '86332', '592', '5064', '1921', '2841', '168', '45726', '15', '490', '1884', '46972', '74458', '2687', '1414', '4482', '1777', '1429', '107406', '2605', '544', '4641', '805', '37380', '132', '3175', '809', '465', '4951', '879', '539', '691', '8970', '94466', '74946', '2161', '334', '1249', '605', '1422', '2383', '3034', '4234', '429', '613', '32444', '3529', '976', '1792', '2900', '1544', '317', '1245', '88', '3396', '5066', '5061', '2433', '8584', '4886', '2657', '110', '241', '662', '671', '89', '2114', '84601', '7300', '4658', '830', '1419', '144', '8827', '7445', '1909', '260', '8363', '1873', '2395', '4727', '1627', '1088', '6552', '3598', '105', '7090', '3418', '2805', '27721', '27674', '928', '513', '942', '1091', '2099', '38061', '2100', '3168', '175', '253', '32029', '5680', '140174', '4734', '3698', '388', '1959', '5729', '647', '203', '650', '61123', '1722', '540', '482', '3556', '52885', '177', '36529', '2059', '25868', '480', '1975', '1556', '333', '892', '11', '349', '3004', '8973', '541', '7451', '6643', '1616', '2166', '83613', '47518', '2312', '5481', '112460', '2333', '1892', '4191', '1620', '3061', '89492', '434', '1729', '25771', '3179', '2617', '546', '3594', '1103', '84187', '1427', '838', '69406', '89774', '4247', '3101', '435', '694', '219', '1479', '4816', '289', '2882', '8464', '155', '1999', '2701', '523', '111759', '468', '2288', '1644', '2527', '891', '911', '1994', '2787', '798', '1594', '1954', '6535', '8984', '2110', '2013', '759', '67087', '2071', '2575', '277', '551', '595', '2043', '8195', '1363', '1950', '3515', '786', '2144', '53435', '2762', '312', '2501', '2470', '2699', '2728', '85414', '1834', '633', '1734', '2371', '1951', '1923', '35957', '410', '1887', '55721', '938', '3489', '4255', '78088', '667', '26258', '599', '1965', '18', '64983', '1535', '94959', '8645', '1694', '2912', '1667', '2107', '1370', '810', '1841', '4133', '2959', '8908', '1244', '8368', '223', '4552', '2671', '3103', '5833', '1941', '1251', '2769', '614', '4034', '4975', '837', '104', '4011', '3527', '762', '1413', '522', '4928', '1957', '5139', '2108', '1591', '1580', '79008', '71520', '467', '668', '628', '8951', '7454', '4979', '1783', '2002', '1927', '1562', '30707', '2097', '3511', '3526', '1835', '141', '924', '4012', '4958', '1785', '256', '2459', '3117', '6620', '345', '65', '502', '1265', '4043', '2613', '267', '1940', '99', '2748', '73', '1376', '4228', '50189', '1888', '381', '36519', '1073', '8617', '2463', '1597', '586', '1552', '145', '1672', '1961', '466', '3016', '457', '1018', '5816', '1944', '3', '697', '2770', '53000', '2018', '833', '1639', '1499', '3543', '4369', '2105', '1995', '558', '4977', '1648', '714', '836', '531', '20', '4464', '4703', '38304', '648', '95', '2771', '6440', '653', '16', '71254', '1405', '1690', '2078', '2193', '1259', '547', '1633', '299', '2122', '3053', '4519', '562', '276', '62999', '164', '165', '806', '1788', '407', '2015', '39446', '94478', '841', '4990', '5', '3177', '1833', '5881', '81229', '215', '204', '101362', '1566', '910', '3210', '54001', '1378', '46578', '2749', '40819', '587', '1947', '86', '2610', '65188', '4709', '180', '337', '1358', '2140', '3083', '1996', '2926', '2252', '537', '236', '3763', '8948', '154', '4327', '1092', '2668', '231', '1366', '122924', '123', '1836', '102', '4443', '30793', '280', '3063', '36527', '2054', '8873', '2436', '1090', '63540', '1590', '594', '2440', '81847', '262', '5686', '437', '524', '784', '489', '2000', '4723', '88812', '1831', '920', '4857', '2642', '673', '58559', '451', '4992', '56949', '2151', '5247', '454', '59', '85', '1583', '45186', '58', '4887', '1262', '2988', '709', '8981', '510', '59387', '4970', '1791', '80241', '272', '224', '1924', '31522', '948'}
MF test predictions saved to: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_15-44-39/mf_test_100000_predictions.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_15-44-39/mmr_test_100000_cosine_top_50.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_15-44-39/mmr_test_100000_jaccard_top_50.csv
Pipeline for movies test finished successfully!
