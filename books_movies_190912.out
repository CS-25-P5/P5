Running on ailab-l4-10
Start time: Tue Dec 16 05:32:23 CET 2025
Activating virtual environment...
Python path: /ceph/home/student.aau.dk/vo55zp/projects/P5/venv/bin/python3
Python version: Python 3.10.12
Running on ailab-l4-10
Start time: Tue Dec 16 05:32:23 CET 2025
Starting pipeline...

=== Running pipeline with weights: relevance=0.5, diversity=0.5 ===
Starting pipeline for movies train
Train matrix: (671, 1242), Val matrix: (610, 1242)
Best MF params: {'k': 60, 'alpha': 0.005, 'lambda_': 0.2}, RMSE=1.0411
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6494
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6543
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mf_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_05-32-25/mf_train_100000_loss_history.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Pipeline for movies train finished successfully!
Start movies test pipeline 
[DEBUG] Filtered users: 613
[DEBUG] Filtered items: 868
[DEBUG] Sample users: [2, 3, 4, 5, 6]
[DEBUG] Sample items: ['101', '102', '104', '1049', '105']
[DEBUG] Predicted ratings shape: (613, 868)
[DEBUG] Min/max predicted rating: 0.8305390614491499/5.705492834516667
MF predictions saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_05-32-25/mf_test_100000_top_50.csv
[DEBUG] Top-N CSV rows: 30650
[DEBUG] Unique users in CSV: 613
[DEBUG] Unique items in CSV: 92
[DEBUG] Sample rows:
   userId  rank  itemId  predictedRating
0       2     1     549         4.414122
1       2     2    1945         4.358058
2       2     3     858         4.341724
3       2     4     318         4.337373
4       2     5     905         4.319272
[DEBUG] Number of candidate items: 92
[DEBUG] Sample candidate items: ['549', '1945', '858', '318', '905']
[DEBUG] predicted_ratings_top_n shape: (613, 92)
[DEBUG] Non-zero entries: 30650
[DEBUG] Max predicted rating: 5.705492834516667
Missing items: {'110', '38061', '3397', '53519', '423', '2805', '866', '101', '364', '36527', '5247', '3483', '8966', '3060', '7445', '4369', '1918', '1257', '799', '1713', '2011', '800', '4886', '691', '15', '410', '7451', '1374', '1680', '3581', '5066', '2252', '44191', '1909', '2912', '2004', '1593', '1633', '8368', '482', '340', '594', '292', '241', '480', '1371', '64983', '2671', '47518', '30793', '3083', '185', '3594', '2124', '1393', '454', '2003', '2001', '2046', '36401', '6440', '7090', '762', '84187', '558', '1372', '331', '89', '58306', '605', '222', '277', '1701', '2116', '2371', '550', '68954', '2140', '1673', '1967', '471', '1968', '77561', '2527', '1923', '2038', '2108', '46972', '1573', '140174', '227', '97938', '3160', '609', '1944', '661', '8973', '982', '1380', '2841', '6373', '2640', '1125', '6957', '2269', '45431', '8833', '1726', '612', '585', '3698', '900', '2085', '508', '434', '2010', '1702', '6537', '8873', '552', '949', '8874', '2005', '522', '93840', '662', '714', '3565', '2123', '165', '2034', '2282', '3638', '3479', '260', '327', '5956', '3512', '4975', '1265', '546', '84944', '1721', '225', '153', '2779', '2033', '104', '1487', '317', '428', '2734', '2291', '337', '1259', '3061', '1911', '39183', '1266', '3053', '592', '1387', '1485', '2017', '2014', '2687', '333', '7454', '6535', '2009', '42011', '798', '1985', '2447', '315', '3178', '637', '778', '2288', '3699', '74458', '2302', '532', '1678', '1269', '83613', '4148', '502', '46578', '55721', '339', '1729', '2006', '86332', '1389', '2470', '711', '3396', '348', '2294', '2022', '3577', '31696', '2015', '1732', '442', '4823', '1995', '1687', '595', '1992', '329', '523', '587', '1059', '924', '2616', '6436', '1788', '11', '2722', '640', '1950', '1358', '224', '2268', '3052', '1394', '2662', '5528', '809', '59387', '805', '265', '40629', '1488', '1682', '4011', '84601', '1887', '1367', '59333', '58', '51540', '1479', '193', '12', '1414', '3117', '4232', '616', '415', '380', '5064', '2118', '3097', '2436', '2642', '2988', '2088', '338', '427', '524', '802', '1594', '1284', '25', '1645', '22', '3536', '6934', '1676', '1590', '6978', '1994', '14', '8366', '213', '1884', '216', '123', '1556', '1894', '2348', '3701', '6552', '2153', '2502', '349', '1653', '6936', '74946', '1375', '2141', '986', '303', '7980', '3051', '40815', '381', '1271', '6620', '102', '63859', '1127', '8665', '2455', '879', '1964', '3763', '52885', '2012', '17', '2000', '2054', '1597', '440', '1734', '2433', '2966', '1588', '55', '345', '168', '2565', '144', '2193', '1416', '4977', '1921', '1997', '1552', '3082', '141', '8011', '2457', '1833', '765', '276', '1892', '2069', '2333', '2395', '74510', '1587', '30707', '2028', '3', '2770', '431', '3173', '24', '160', '27721', '45186', '531', '54503', '8014', '239', '2428', '1785', '3081', '4896', '1779', '1566', '3090', '1956', '2', '36519', '2099', '1584', '5', '1091', '2080', '2749', '262', '4723', '2459', '4255', '2266', '31685', '247', '928', '383', '2144', '3210', '628', '8371', '3418', '429', '55765', '4344', '266', '2312', '81229', '155', '2262', '1791', '112', '1285', '2728', '4970', '2013', '2383', '8984', '62', '3016', '5686', '919', '81', '4247', '535', '2978', '81847', '492', '1088', '3556', '1377', '64', '44004', '223', '235', '5902', '2151', '648', '708', '553', '44694', '1688', '497', '1835', '513', '783', '593', '8985', '172', '2059', '441', '1366', '3527', '1589', '6003', '40819', '4979', '788', '910', '1396', '4351', '1836', '551', '88', '1957', '5608', '2993', '111759', '2067', '588', '2762', '47610', '249', '5481', '5816', '8645', '46976', '673', '8981', '4701', '917', '1959', '2321', '1975', '272', '33660', '481', '2239', '1378', '500', '8464', '4974', '261', '1991', '300', '2094', '5991', '195', '198', '2313', '2324', '541', '1544', '2135', '1213', '1641', '207', '2349', '2605', '107406', '2082', '4012', '838', '1249', '3101', '135', '4191', '597', '2110', '2112', '4254', '468', '4228', '4709', '2111', '2253', '3011', '378', '18', '54001', '293', '1499', '2161', '2109', '2699', '3526', '377', '955', '2125', '1272', '204', '586', '786', '1951', '1282', '1162', '540', '2114', '231', '839', '4643', '2861', '145', '1376', '39446', '2959', '1809', '2139', '5881', '455', '82', '4034', '3004', '379', '2100', '1882', '543', '1954', '85788', '1949', '31410', '53000', '2567', '5680', '4880', '26712', '16', '2335', '5620', '1792', '4734', '1278', '2890', '780', '107', '1251', '21', '48385', '3033', '6', '70', '2334', '334', '78088', '1405', '163', '1777', '2463', '2263', '4638', '494', '452', '1049', '150', '932', '1610', '2084', '2657', '186', '2791', '33166', '861', '44022', '1090', '1244', '173', '1858', '2617', '1907', '41566', '2058', '804', '3168', '8961', '627', '2166', '2078', '5483', '3175', '596', '671', '830', '280', '19', '2115', '5121', '3549', '215', '8810', '909', '832', '1619', '256', '891', '169', '4958', '1373', '436', '252', '1888', '105', '5147', '6283', '1834', '2232', '1639', '49530', '1092', '236', '2142', '1717', '1580', '2787', '3034', '25750', '3176', '350', '47099', '36529', '1124', '79', '1917', '85414', '950', '4857', '170', '2860', '914', '457', '2761', '2694', '314', '1246', '2528', '806', '509', '3980', '1958', '1722', '1586', '2122', '316', '50189', '1608', '8970', '2926', '4889', '1611', '2134', '332', '435', '920', '1875', '1885', '79553', '647', '45722', '177', '678', '62999', '2105', '3578', '1073', '6643', '26133', '158', '2143', '4641', '849', '1690', '1591', '2701', '2355', '5060', '5061', '94959', '1961', '95', '53129', '2539', '65', '1562', '6058', '288', '2261', '344', '1093', '1103', '2297', '3146', '2759', '2018', '784', '1407', '3114', '3635', '253', '20', '161', '4441', '54272', '1947', '4031', '3489', '539', '466', '4995', '562', '88744', '1262', '1370', '590', '653', '180', '196', '2089', '837', '902', '1772', '342', '319', '6593', '1895', '942', '613', '841', '1247', '1581', '1615', '2989', '4816', '6947', '2087', '2160', '89492', '1831', '1391', '4025', '2002'}
MF test predictions saved to: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_05-32-25/mf_test_100000_predictions.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_05-32-25/mmr_test_100000_cosine_top_50.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_05-32-25/mmr_test_100000_jaccard_top_50.csv
Pipeline for movies test finished successfully!
