Running on ailab-l4-09
Start time: Tue Dec 16 03:52:35 CET 2025
Activating virtual environment...
Python path: /ceph/home/student.aau.dk/vo55zp/projects/P5/venv/bin/python3
Python version: Python 3.10.12
Running on ailab-l4-09
Start time: Tue Dec 16 03:52:35 CET 2025
Starting pipeline...

=== Running pipeline with weights: relevance=0.5, diversity=0.5 ===
Starting pipeline for movies train
Train matrix: (671, 1242), Val matrix: (610, 1242)
Best MF params: {'k': 60, 'alpha': 0.005, 'lambda_': 0.2}, RMSE=1.0411
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6502
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6564
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mf_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_03-52-37/mf_train_100000_loss_history.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Pipeline for movies train finished successfully!
Start movies test pipeline 
[DEBUG] Filtered users: 613
[DEBUG] Filtered items: 868
[DEBUG] Sample users: [2, 3, 4, 5, 6]
[DEBUG] Sample items: ['101', '102', '104', '1049', '105']
[DEBUG] Predicted ratings shape: (613, 868)
[DEBUG] Min/max predicted rating: 0.8305390614491499/5.705492834516667
MF predictions saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_03-52-37/mf_test_100000_top_50.csv
[DEBUG] Top-N CSV rows: 30650
[DEBUG] Unique users in CSV: 613
[DEBUG] Unique items in CSV: 92
[DEBUG] Sample rows:
   userId  rank  itemId  predictedRating
0       2     1     549         4.414122
1       2     2    1945         4.358058
2       2     3     858         4.341724
3       2     4     318         4.337373
4       2     5     905         4.319272
[DEBUG] Number of candidate items: 92
[DEBUG] Sample candidate items: ['549', '1945', '858', '318', '905']
[DEBUG] predicted_ratings_top_n shape: (613, 92)
[DEBUG] Non-zero entries: 30650
[DEBUG] Max predicted rating: 5.705492834516667
Missing items: {'2139', '1269', '8371', '6440', '64', '1995', '3146', '2926', '5620', '838', '2089', '89492', '3565', '1907', '6552', '350', '4977', '661', '2124', '6535', '47518', '879', '215', '74458', '2046', '2605', '1371', '2054', '982', '1580', '1367', '1587', '155', '186', '762', '1887', '1858', '4031', '1892', '2268', '1394', '524', '3034', '4889', '3173', '919', '891', '2088', '1633', '2762', '195', '316', '4641', '53519', '112', '1162', '1266', '1380', '1951', '8810', '3061', '423', '16', '6936', '3', '160', '364', '3763', '595', '7980', '2528', '471', '837', '8874', '6934', '140174', '508', '85788', '3011', '2993', '2565', '68954', '2067', '169', '1985', '2001', '2263', '415', '1968', '4974', '4025', '4880', '1959', '653', '2125', '173', '3577', '86332', '546', '79', '177', '1358', '1992', '83613', '552', '3114', '1619', '784', '1544', '78088', '381', '550', '1485', '5060', '327', '1641', '2143', '198', '39446', '3479', '4369', '8985', '454', '786', '932', '1244', '1722', '647', '627', '950', '616', '1376', '2142', '1247', '434', '909', '55721', '6978', '765', '4643', '89', '4255', '144', '605', '46578', '42011', '231', '6957', '7451', '1734', '2701', '2004', '26712', '2160', '2141', '832', '26133', '1090', '539', '532', '2123', '44004', '2262', '1259', '2100', '2011', '2699', '778', '457', '8970', '79553', '5991', '5', '33166', '1888', '522', '1566', '2006', '2288', '2642', '4351', '1246', '17', '45186', '3396', '2890', '52885', '2028', '3168', '2805', '5247', '1957', '1416', '224', '2151', '2108', '2861', '2433', '3527', '4232', '5121', '84944', '2105', '1499', '1836', '2153', '292', '494', '58306', '8981', '88744', '45431', '1251', '452', '4995', '2348', '93840', '1125', '3701', '36401', '2988', '2436', '466', '841', '6537', '2428', '331', '293', '378', '36529', '1911', '1488', '2282', '3489', '523', '2005', '1249', '2252', '104', '1396', '3117', '2687', '2617', '1594', '2722', '2860', '2334', '2253', '185', '2038', '55765', '314', '6283', '1284', '1717', '1687', '628', '2109', '1729', '163', '2239', '2080', '2003', '585', '36519', '7454', '329', '802', '2111', '8011', '3526', '54272', '2022', '94959', '1947', '213', '2371', '2395', '25', '3051', '799', '2', '2959', '806', '111759', '1372', '62', '830', '986', '5481', '193', '2787', '3483', '1653', '4012', '5147', '74510', '592', '861', '2770', '30793', '342', '1377', '1690', '481', '276', '500', '562', '63859', '5483', '8966', '62999', '8973', '2018', '2033', '81', '31410', '3083', '1967', '1556', '19', '1285', '1366', '4701', '637', '1950', '123', '4734', '348', '640', '46976', '597', '253', '105', '594', '541', '2567', '442', '8645', '88', '1573', '588', '5608', '1584', '44694', '47610', '2455', '2791', '2087', '53129', '2266', '1994', '107406', '241', '4148', '223', '2302', '798', '3160', '55', '543', '1391', '1923', '1975', '150', '1884', '47099', '849', '2085', '216', '204', '2078', '3097', '24', '2694', '441', '558', '1954', '2527', '1552', '2082', '4709', '5680', '2912', '1271', '260', '102', '1713', '280', '955', '671', '2017', '2841', '1073', '85414', '429', '379', '3210', '261', '12', '1597', '2616', '3033', '3581', '509', '65', '900', '593', '4823', '1791', '5902', '2355', '691', '2321', '5066', '349', '1088', '18', '2059', '107', '590', '1964', '3699', '924', '2734', '1909', '1682', '170', '839', '4638', '482', '917', '58', '3053', '8366', '1370', '1958', '2502', '4441', '4857', '3176', '497', '1688', '1127', '6593', '84601', '2140', '1375', '265', '15', '714', '101', '51540', '1833', '3060', '8961', '468', '1918', '44191', '436', '110', '1262', '4970', '4191', '153', '1701', '902', '165', '4011', '3397', '239', '168', '334', '1093', '2134', '2010', '54001', '3698', '1608', '1676', '4247', '53000', '8014', '6058', '2297', '4228', '3536', '809', '678', '2779', '866', '910', '2012', '50189', '1213', '1479', '2383', '82', '800', '1702', '2447', '319', '2539', '553', '2009', '2112', '2989', '1788', '1997', '596', '5064', '40629', '4979', '41566', '502', '2013', '5686', '2662', '81847', '45722', '708', '6', '1091', '1895', '1610', '2728', '332', '1581', '2161', '27721', '2144', '2002', '480', '3635', '4886', '1831', '1589', '77561', '256', '4254', '95', '431', '2457', '1917', '783', '3082', '535', '1124', '1772', '158', '1835', '2333', '2294', '1407', '2000', '3016', '586', '20', '3418', '1049', '1944', '2015', '40815', '3594', '161', '3101', '2470', '303', '54503', '46972', '1991', '272', '2118', '2966', '949', '1265', '662', '40819', '551', '252', '31685', '1414', '2657', '1059', '6373', '2312', '1777', '2069', '1389', '3178', '1678', '48385', '2978', '2324', '540', '410', '2313', '492', '2014', '4344', '3090', '247', '1374', '788', '1257', '2058', '2166', '612', '6436', '1593', '1673', '1961', '3980', '455', '6003', '11', '805', '8464', '2232', '3081', '380', '30707', '2269', '1393', '1885', '1405', '2335', '59333', '513', '1591', '2094', '2122', '1732', '920', '236', '1949', '345', '4723', '2459', '1894', '5528', '2671', '1278', '587', '1792', '2116', '2261', '3512', '3578', '711', '1588', '8984', '1562', '2749', '435', '2640', '8873', '1615', '5881', '2759', '36527', '317', '1680', '942', '33660', '377', '4958', '4034', '14', '1282', '2291', '1785', '1834', '207', '2099', '22', '383', '8368', '172', '3052', '196', '2110', '1487', '49530', '1779', '333', '338', '1882', '6947', '6620', '222', '288', '2193', '2135', '262', '1590', '339', '44022', '141', '1103', '225', '31696', '84187', '135', '1092', '1611', '4896', '2034', '21', '673', '928', '914', '227', '8833', '25750', '804', '70', '7445', '780', '180', '4816', '4975', '1639', '315', '2084', '1373', '531', '5956', '427', '1726', '1921', '648', '3549', '1645', '344', '8665', '235', '5061', '1721', '300', '1956', '3004', '337', '428', '277', '1586', '5816', '38061', '81229', '613', '97938', '3638', '39183', '2349', '6643', '1387', '266', '74946', '2115', '2463', '3556', '59387', '145', '609', '2761', '64983', '2114', '1809', '1378', '440', '1875', '7090', '3175', '249', '1272', '340'}
MF test predictions saved to: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_03-52-37/mf_test_100000_predictions.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_03-52-37/mmr_test_100000_cosine_top_50.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_03-52-37/mmr_test_100000_jaccard_top_50.csv
Pipeline for movies test finished successfully!
