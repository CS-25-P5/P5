Running on ailab-l4-07
Start time: Tue Dec 16 01:30:21 CET 2025
Activating virtual environment...
Python path: /ceph/home/student.aau.dk/vo55zp/projects/P5/venv/bin/python3
Python version: Python 3.10.12
Running on ailab-l4-07
Start time: Tue Dec 16 01:30:21 CET 2025
Starting pipeline...

=== Running pipeline with weights: relevance=0.5, diversity=0.5 ===
Starting pipeline for movies train
Train matrix: (671, 1242), Val matrix: (610, 1242)
Best MF params: {'k': 60, 'alpha': 0.005, 'lambda_': 0.2}, RMSE=1.0411
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6502
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6564
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mf_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_01-30-23/mf_train_100000_loss_history.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Pipeline for movies train finished successfully!
Start movies test pipeline 
[DEBUG] Filtered users: 613
[DEBUG] Filtered items: 868
[DEBUG] Sample users: [2, 3, 4, 5, 6]
[DEBUG] Sample items: ['101', '102', '104', '1049', '105']
[DEBUG] Predicted ratings shape: (613, 868)
[DEBUG] Min/max predicted rating: 0.8305390614491499/5.705492834516667
MF predictions saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_01-30-23/mf_test_100000_top_50.csv
[DEBUG] Top-N CSV rows: 30650
[DEBUG] Unique users in CSV: 613
[DEBUG] Unique items in CSV: 92
[DEBUG] Sample rows:
   userId  rank  itemId  predictedRating
0       2     1     549         4.414122
1       2     2    1945         4.358058
2       2     3     858         4.341724
3       2     4     318         4.337373
4       2     5     905         4.319272
[DEBUG] Number of candidate items: 92
[DEBUG] Sample candidate items: ['549', '1945', '858', '318', '905']
[DEBUG] predicted_ratings_top_n shape: (613, 92)
[DEBUG] Non-zero entries: 30650
[DEBUG] Max predicted rating: 5.705492834516667
Missing items: {'5991', '2805', '3090', '1593', '64', '1262', '3016', '431', '180', '303', '1088', '543', '110', '5881', '177', '4228', '6535', '1090', '2762', '4857', '2012', '30707', '435', '942', '2134', '590', '3176', '648', '44694', '2701', '344', '2080', '53129', '5066', '2312', '949', '315', '866', '288', '2966', '5956', '562', '2022', '1257', '2108', '4369', '594', '252', '185', '4709', '196', '2124', '6978', '2004', '2017', '1732', '1888', '592', '24', '1785', '861', '647', '928', '2662', '924', '7454', '4823', '4701', '145', '8973', '4255', '59387', '85788', '81', '6620', '2139', '1729', '2142', '1682', '4723', '481', '1992', '1584', '2010', '2054', '551', '3052', '2089', '2749', '3565', '2018', '3638', '3980', '1959', '141', '6643', '2123', '2252', '1610', '2993', '1246', '2457', '2067', '81229', '4441', '2125', '5902', '247', '59333', '1688', '2978', '1213', '1125', '612', '169', '2033', '3549', '327', '5247', '1049', '2239', '2324', '1372', '1366', '338', '45431', '1378', '2009', '4979', '762', '466', '2153', '16', '7451', '1285', '329', '539', '173', '2989', '541', '3512', '1858', '2105', '2687', '4975', '627', '535', '1278', '364', '671', '225', '314', '158', '1673', '241', '1911', '1995', '345', '2455', '5121', '2605', '1608', '42011', '53519', '193', '902', '982', '3578', '1092', '550', '8984', '236', '637', '661', '55', '300', '1162', '434', '1591', '4191', '144', '11', '107406', '140174', '1269', '1639', '104', '3117', '3051', '1967', '2099', '2383', '932', '1958', '102', '36527', '532', '2005', '333', '6537', '784', '378', '82', '2114', '31685', '468', '2014', '18', '70', '830', '272', '1887', '914', '1834', '2161', '3160', '3060', '3097', '1552', '523', '2433', '213', '377', '160', '596', '337', '4025', '1884', '524', '3178', '381', '8464', '348', '3146', '1611', '2268', '2565', '53000', '1127', '3396', '2334', '3101', '1588', '2232', '5528', '2890', '708', '8985', '39446', '2115', '2355', '585', '2539', '653', '8833', '8961', '1957', '3081', '3053', '227', '508', '1885', '552', '613', '186', '1562', '150', '2671', '2013', '1266', '1918', '1394', '249', '265', '1777', '1788', '1586', '1791', '22', '2841', '46972', '7980', '454', '2779', '765', '440', '2294', '3175', '2116', '260', '3397', '161', '3635', '2109', '427', '8981', '84944', '3011', '5686', '1244', '172', '429', '2269', '47518', '492', '2860', '1722', '280', '3701', '3698', '441', '112', '78088', '3526', '256', '1917', '806', '522', '1272', '97938', '1587', '36519', '17', '74458', '6957', '7090', '8810', '2959', '2046', '6', '195', '2094', '1892', '319', '2034', '1641', '3', '2082', '5', '1615', '33166', '900', '8966', '8371', '452', '4148', '3489', '2006', '2084', '55721', '84601', '640', '1358', '74946', '1073', '5483', '2000', '2787', '49530', '497', '2321', '2348', '1680', '673', '3061', '2262', '47610', '3082', '5608', '235', '783', '6058', '4351', '1393', '1479', '1702', '1975', '239', '2028', '25', '4734', '349', '436', '224', '471', '88744', '955', '2100', '3699', '513', '6003', '4012', '500', '2502', '6436', '1968', '1414', '1589', '1619', '1907', '799', '5680', '2282', '6373', '383', '4995', '2141', '1371', '1894', '1985', '207', '1556', '3210', '54001', '135', '4958', '909', '1485', '4254', '1590', '1376', '222', '798', '2428', '714', '1734', '2087', '2297', '609', '58', '15', '2002', '1835', '40819', '1373', '2140', '2263', '14', '293', '2253', '5147', '1367', '84187', '849', '482', '2395', '480', '2926', '1991', '5064', '2118', '800', '423', '6440', '3581', '261', '2912', '40815', '4643', '1407', '2371', '44191', '1779', '2349', '1573', '36401', '45722', '46976', '276', '5061', '809', '1391', '54503', '27721', '8874', '231', '442', '2110', '2722', '38061', '2291', '839', '31410', '531', '2288', '26712', '36529', '2640', '4974', '48385', '55765', '198', '4816', '804', '26133', '662', '2160', '6593', '1809', '2088', '2463', '841', '168', '3173', '101', '1949', '21', '2759', '2', '1713', '4232', '5481', '2038', '2166', '3004', '1377', '44004', '7445', '334', '1831', '410', '4970', '6283', '1947', '1405', '1717', '165', '51540', '20', '39183', '19', '277', '40629', '45186', '86332', '891', '586', '832', '3763', '2861', '12', '1994', '597', '2528', '4889', '595', '85414', '778', '170', '1895', '8014', '204', '546', '2144', '1690', '3033', '63859', '79', '1265', '5060', '1282', '332', '107', '1951', '1544', '1792', '2699', '2527', '415', '1687', '788', '1259', '46578', '52885', '81847', '8368', '605', '62', '6936', '58306', '44022', '1389', '88', '1633', '50189', '2459', '1249', '2436', '4034', '1956', '593', '1950', '2335', '8645', '1954', '2001', '2151', '65', '62999', '216', '30793', '2728', '4896', '292', '2261', '253', '1059', '588', '3556', '105', '950', '89492', '1416', '1487', '8366', '1284', '678', '331', '1247', '1580', '25750', '8011', '89', '2313', '2694', '1882', '1678', '2770', '1581', '1374', '1836', '2069', '339', '2078', '780', '2058', '2003', '2122', '920', '2266', '1676', '350', '4886', '509', '266', '342', '616', '1645', '3594', '1997', '3536', '4641', '1701', '74510', '540', '1923', '1721', '786', '1772', '1833', '4247', '4638', '1921', '1380', '1271', '2791', '3034', '553', '2470', '215', '4011', '8873', '3479', '1488', '6934', '68954', '1251', '837', '2011', '2567', '5816', '986', '4977', '2988', '2111', '2761', '3083', '316', '380', '2015', '4880', '2617', '111759', '8665', '691', '163', '3527', '79553', '8970', '317', '917', '2135', '2616', '33660', '41566', '1964', '2085', '2143', '805', '262', '31696', '1093', '153', '5620', '3168', '64983', '879', '1909', '2333', '1594', '3577', '711', '6552', '455', '457', '2302', '6947', '1653', '2642', '802', '94959', '47099', '1124', '1875', '2112', '3114', '428', '2447', '379', '587', '910', '2193', '54272', '77561', '340', '2657', '1961', '1566', '1597', '83613', '1726', '223', '1103', '1387', '628', '1499', '155', '3483', '1370', '919', '2734', '494', '1944', '4344', '1091', '4031', '93840', '123', '502', '838', '95', '3418', '1396', '558', '1375', '2059'}
MF test predictions saved to: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_01-30-23/mf_test_100000_predictions.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_01-30-23/mmr_test_100000_cosine_top_50.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_01-30-23/mmr_test_100000_jaccard_top_50.csv
Pipeline for movies test finished successfully!
