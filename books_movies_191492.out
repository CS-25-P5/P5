Running on ailab-l4-04
Start time: Tue Dec 16 14:57:31 CET 2025
Activating virtual environment...
Python path: /ceph/home/student.aau.dk/vo55zp/projects/P5/venv/bin/python3
Python version: Python 3.10.12
Running on ailab-l4-04
Start time: Tue Dec 16 14:57:31 CET 2025
Starting pipeline...

=== Running pipeline with weights: relevance=0.5, diversity=0.5 ===
Starting pipeline for movies train
Train matrix: (671, 1242), Val matrix: (610, 1242)
Best MF params: {'k': 60, 'alpha': 0.005, 'lambda_': 0.2}, RMSE=1.0411
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6483
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6539
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mf_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_14-57-33/mf_train_100000_loss_history.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Pipeline for movies train finished successfully!
Start movies test pipeline 
[DEBUG] Filtered users: 613
[DEBUG] Filtered items: 1242
[DEBUG] Sample users: [2, 3, 4, 5, 6]
[DEBUG] Sample items: ['101', '101362', '1018', '102', '1023']
[DEBUG] Predicted ratings shape: (613, 1242)
[DEBUG] Min/max predicted rating: 0.8305390614491499/5.737256786033441
predicted_ratings.shape: (613, 1242)
R_filtered.shape: (613, 1178)
MF predictions saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_14-57-33/mf_test_100000_top_50.csv
[DEBUG] Top-N CSV rows: 30650
[DEBUG] Unique users in CSV: 613
[DEBUG] Unique items in CSV: 108
[DEBUG] Sample rows:
   userId  rank  itemId  predictedRating
0       2     1     549         4.414122
1       2     2    2924         4.402179
2       2     3    1939         4.380564
3       2     4    1945         4.358058
4       2     5     858         4.341724
[DEBUG] Number of candidate items: 108
[DEBUG] Sample candidate items: ['549', '2924', '1939', '1945', '858']
[DEBUG] predicted_ratings_top_n shape: (613, 108)
[DEBUG] Non-zero entries: 30650
[DEBUG] Max predicted rating: 5.737256786033441
Missing items: {'5147', '1858', '2117', '2642', '1247', '2114', '1393', '345', '2082', '41569', '69784', '837', '1213', '6078', '6947', '175', '2668', '2043', '329', '3396', '3699', '1687', '1941', '63859', '3515', '1863', '5729', '1586', '523', '31685', '436', '67087', '2144', '8337', '3173', '2110', '165', '6003', '1257', '46972', '407', '74944', '5483', '924', '588', '4191', '1954', '1777', '2048', '2787', '144', '1488', '53129', '590', '5991', '102', '455', '1440', '1552', '1831', '809', '4727', '37380', '8645', '1627', '6', '1265', '204', '2054', '2161', '2433', '1429', '5780', '61123', '173', '5816', '56801', '222', '43919', '2791', '7451', '101362', '594', '4978', '49396', '56152', '4474', '1092', '114060', '1911', '79224', '1924', '1682', '5064', '6961', '288', '2013', '547', '8981', '7980', '1885', '936', '4566', '1124', '553', '64499', '1587', '74948', '4133', '788', '4482', '2463', '6058', '1779', '2124', '340', '539', '671', '2255', '2034', '558', '2058', '4896', '1245', '742', '18', '171', '2694', '4734', '494', '8908', '8874', '2134', '2759', '2749', '1566', '36527', '22', '1373', '2089', '552', '2748', '2349', '1865', '1251', '111759', '415', '241', '5061', '1273', '440', '458', '1059', '94478', '4816', '2734', '78041', '4974', '1791', '783', '5051', '2012', '2122', '2094', '2605', '236', '185', '2261', '4519', '605', '891', '480', '4975', '609', '86332', '62', '4951', '513', '2105', '421', '4995', '4643', '26680', '5247', '337', '1608', '25868', '4701', '3701', '193', '89', '824', '2253', '1378', '595', '154', '74', '661', '670', '5956', '1978', '3536', '1407', '2334', '2817', '6440', '2133', '5187', '1888', '161', '1268', '429', '86', '1380', '587', '1394', '910', '5481', '798', '2067', '260', '481', '2722', '123', '1713', '3060', '272', '8833', '842', '879', '1688', '1648', '3479', '2084', '4658', '466', '2288', '349', '1882', '551', '315', '2687', '160', '2112', '2', '2069', '2005', '293', '5881', '2302', '1783', '3057', '1049', '1641', '16', '1875', '4992', '186', '32031', '2383', '19', '4327', '8194', '262', '1636', '112', '4011', '115210', '3033', '322', '1589', '24', '1683', '4111', '1927', '14', '637', '1419', '4977', '614', '667', '1726', '6466', '8966', '300', '3578', '2470', '6934', '6970', '2038', '48385', '502', '2109', '44004', '543', '2107', '1375', '4516', '2118', '5060', '434', '8985', '5620', '8973', '107406', '253', '3063', '2252', '153', '86320', '6537', '1639', '2469', '593', '3786', '1975', '6552', '1593', '1957', '1729', '1597', '818', '53435', '426', '35957', '1371', '452', '219', '3526', '647', '1717', '350', '1599', '170', '914', '799', '1024', '1792', '833', '2080', '4889', '38061', '917', '2000', '1088', '364', '648', '532', '83613', '8368', '931', '59', '44694', '1701', '46967', '1848', '72733', '1672', '1090', '524', '95', '800', '3638', '155', '1246', '606', '59387', '2071', '1422', '39446', '467', '3635', '4979', '8011', '4880', '482', '678', '948', '599', '317', '64983', '2099', '1997', '2528', '1376', '640', '708', '62999', '84944', '2516', '2753', '33166', '8984', '1051', '1694', '7454', '383', '4546', '84187', '2087', '54503', '3118', '1162', '3937', '3512', '3176', '40826', '454', '8970', '3178', '2440', '2282', '5048', '489', '6643', '2926', '3698', '314', '1735', '442', '20', '79553', '1964', '3766', '6978', '26258', '2860', '3594', '3097', '21', '105', '4641', '920', '1018', '2640', '1653', '2262', '1947', '2294', '2699', '2575', '1541', '4638', '1358', '1665', '441', '25750', '4857', '2976', '1807', '687', '6283', '303', '180', '56949', '2657', '596', '1965', '195', '80241', '1271', '2287', '68954', '46976', '348', '4291', '89774', '1244', '4614', '2020', '4234', '849', '150', '4344', '633', '836', '2610', '40629', '522', '53883', '1895', '2890', '2004', '42002', '1487', '4232', '3004', '2993', '1089', '2333', '4676', '177', '1556', '544', '662', '2436', '256', '1277', '2805', '26776', '2017', '7216', '57353', '2728', '6609', '47099', '8373', '8014', '6593', '39414', '8366', '2979', '277', '378', '1923', '2966', '2142', '2989', '2335', '4552', '164', '135', '267', '71254', '1616', '2988', '1835', '26810', '1387', '6641', '122924', '32582', '85', '247', '1772', '1372', '2151', '31522', '2116', '2153', '3074', '759', '53519', '4012', '1485', '4956', '203', '841', '104', '1259', '508', '45722', '1721', '1619', '2892', '2912', '3082', '377', '216', '804', '2457', '78088', '3175', '333', '46578', '1369', '424', '2193', '58306', '2166', '2139', '2978', '5528', '38304', '802', '1940', '1958', '3565', '65', '4823', '63540', '2639', '1588', '2567', '5', '74946', '2312', '630', '7234', '2009', '96821', '2779', '1834', '33495', '15', '1951', '531', '47721', '471', '84601', '45726', '207', '6538', '2002', '1366', '89492', '1994', '929', '1917', '145', '2324', '4958', '435', '27674', '4031', '500', '2789', '198', '3511', '3114', '81', '59333', '172', '26133', '2455', '259', '5121', '2770', '1836', '8617', '3090', '1282', '2527', '1995', '2313', '71520', '4441', '550', '4709', '30', '6957', '65188', '6373', '762', '3146', '919', '3581', '132', '2135', '1892', '2266', '8016', '248', '2046', '3101', '1091', '25', '1645', '93855', '2100', '4587', '616', '4034', '3547', '2882', '1956', '1580', '2044', '163', '4970', '3', '1920', '778', '30793', '1127', '94466', '3179', '4369', '1544', '8464', '235', '1272', '3527', '909', '99', '32029', '490', '4254', '1573', '2001', '2097', '831', '2239', '3051', '1269', '1583', '2059', '169', '85788', '332', '42734', '2104', '380', '40819', '12', '2006', '70', '510', '107', '7445', '612', '806', '2841', '1266', '982', '2018', '26614', '5833', '97938', '711', '673', '4255', '1370', '88812', '141', '457', '597', '2616', '2574', '653', '276', '8827', '6473', '3681', '1262', '1581', '1249', '810', '1377', '540', '1497', '1966', '507', '33660', '53000', '425', '650', '1667', '1992', '1093', '2459', '292', '537', '1985', '3079', '8860', '805', '938', '2232', '62956', '289', '830', '1374', '2148', '3577', '2010', '1631', '312', '74545', '838', '1676', '1673', '7300', '379', '714', '3160', '44191', '4228', '897', '3052', '327', '5139', '1635', '1833', '2011', '2088', '1968', '585', '140174', '1610', '51540', '50189', '2613', '1809', '2095', '3177', '2671', '94959', '839', '218', '34334', '694', '55721', '8665', '27721', '223', '8584', '586', '8008', '2003', '832', '2501', '3543', '3549', '1944', '627', '1405', '32444', '3556', '697', '949', '613', '942', '80831', '2861', '82', '74458', '1907', '41571', '2269', '299', '6436', '26111', '1730', '2171', '635', '224', '2371', '334', '2761', '25753', '7090', '8968', '227', '390', '2111', '2123', '4703', '1690', '866', '4837', '36529', '2769', '1125', '101', '410', '266', '79', '1535', '215', '1479', '784', '39183', '4990', '25771', '986', '423', '26842', '2348', '1680', '911', '42632', '6535', '2762', '43936', '870', '892', '5927', '2143', '1594', '2115', '2015', '196', '2701', '2141', '1991', '1363', '4723', '4443', '5686', '2539', '1413', '2259', '69406', '2162', '1389', '4105', '3489', '3980', '2028', '4247', '44022', '562', '541', '8961', '2155', '902', '168', '8371', '492', '1887', '316', '344', '3103', '1873', '31116', '58', '2291', '8129', '1959', '1414', '1949', '848', '2022', '2085', '5961', '668', '3763', '7347', '1633', '861', '3598', '976', '42011', '261', '6620', '339', '428', '4480', '709', '1284', '84152', '1615', '1950', '3418', '3053', '225', '3110', '231', '64', '3016', '2502', '347', '81229', '1562', '2662', '3081', '2447', '254', '40815', '55', '2771', '928', '2900', '1996', '2617', '900', '54001', '5902', '451', '3210', '8363', '1591', '535', '90374', '5899', '8195', '468', '4886', '2268', '1788', '765', '2355', '46335', '2033', '1584', '3397', '54272', '427', '2959', '4928', '1416', '1678', '47610', '3117', '1023', '1590', '1961', '213', '81847', '1285', '4887', '5680', '26', '2078', '88', '950', '1785', '11', '158', '8987', '1644', '437', '2014', '3034', '1611', '17', '381', '388', '77561', '112460', '5066', '3011', '1732', '1909', '955', '342', '331', '338', '2752', '4464', '2125', '8810', '74510', '88744', '3168', '1629', '8873', '780', '2428', '1391', '1734', '73', '1073', '85414', '2788', '249', '691', '431', '1841', '2321', '497', '30707', '5608', '63876', '1722', '1702', '4043', '5056', '4279', '1367', '47518', '1894', '881', '45186', '58559', '2297', '504', '3061', '1427', '41566', '988', '2108', '2370', '5319', '1884', '2160', '3483', '1967', '52885', '110', '93840', '3083', '786', '31410', '6936', '3529', '26712', '319', '79008', '2565', '393', '2140', '1441', '27706', '4520', '509', '8951', '280', '465', '1103', '932', '2395', '36401', '275', '265', '4025', '1620', '31696', '592', '2263', '252', '2322', '8948', '2577', '1278', '575', '45431', '1499', '546', '1999', '239', '4351', '55765', '36519', '49530', '4148', '460', '1921', '761', '71282', '1918', '1396', '628'}
MF test predictions saved to: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_14-57-33/mf_test_100000_predictions.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_14-57-33/mmr_test_100000_cosine_top_50.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_14-57-33/mmr_test_100000_jaccard_top_50.csv
Pipeline for movies test finished successfully!
