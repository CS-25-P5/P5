Running on ailab-l4-10
Start time: Wed Dec 17 13:35:00 CET 2025
Activating virtual environment...
Python path: /ceph/home/student.aau.dk/vo55zp/projects/P5/venv/bin/python3
Python version: Python 3.10.12
Running on ailab-l4-10
Start time: Wed Dec 17 13:35:00 CET 2025
Starting pipeline...

=== Running pipeline with weights: relevance=0.5, diversity=0.5 ===
Starting pipeline for movies train
Train matrix: (671, 1242), Val matrix: (610, 1242)
Training complete. Best epoch: 3, Best train RMSE: 0.9024, Best val RMSE: 1.0280
Training complete. Best epoch: 4, Best train RMSE: 0.8871, Best val RMSE: 1.0271
Training complete. Best epoch: 4, Best train RMSE: 0.8890, Best val RMSE: 1.0262
Training complete. Best epoch: 2, Best train RMSE: 0.8987, Best val RMSE: 1.0286
Training complete. Best epoch: 2, Best train RMSE: 0.8998, Best val RMSE: 1.0277
Training complete. Best epoch: 2, Best train RMSE: 0.9013, Best val RMSE: 1.0268
Training complete. Best epoch: 1, Best train RMSE: 0.9405, Best val RMSE: 1.0287
Training complete. Best epoch: 1, Best train RMSE: 0.9410, Best val RMSE: 1.0278
Training complete. Best epoch: 1, Best train RMSE: 0.9416, Best val RMSE: 1.0269
Best (alpha, lambda) from Stage 1: {'alpha': 0.005, 'lambda_': 0.1}, RMSE=1.0262
Training complete. Best epoch: 4, Best train RMSE: 0.8890, Best val RMSE: 1.0262
Training complete. Best epoch: 4, Best train RMSE: 0.8858, Best val RMSE: 1.0265
Training complete. Best epoch: 4, Best train RMSE: 0.8824, Best val RMSE: 1.0281
Best k from Stage 2: 20, RMSE=1.0262
Best MF params: {'alpha': 0.005, 'lambda_': 0.1, 'k': 20}, RMSE=1.0262
Training complete. Best epoch: 4, Best train RMSE: 0.8890, Best val RMSE: 1.0262
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.35000000000000003 with score 0.7449
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.25 with score 0.7475
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mf_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-17_13-35-33/mf_train_100000_loss_history.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Pipeline for movies train finished successfully!
Start movies test pipeline 
[DEBUG] Filtered users: 613
[DEBUG] Filtered items: 1242
[DEBUG] Sample users: [2, 3, 4, 5, 6]
[DEBUG] Sample items: ['101', '101362', '1018', '102', '1023']
[DEBUG] Predicted ratings shape: (613, 1242)
[DEBUG] Min/max predicted rating: 1.9010127210592536/5.112896117768185
predicted_ratings.shape: (613, 1242)
R_filtered.shape: (613, 1178)
MF predictions saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-17_13-35-33/mf_test_100000_top_50.csv
[DEBUG] Top-N CSV rows: 30650
[DEBUG] Unique users in CSV: 613
[DEBUG] Unique items in CSV: 102
[DEBUG] Sample rows:
   userId  rank  itemId  predictedRating
0       2     1     318         4.405279
1       2     2     858         4.384709
2       2     3     527         4.208042
3       2     4     608         4.200962
4       2     5     260         4.193586
[DEBUG] Number of candidate items: 102
[DEBUG] Sample candidate items: ['318', '858', '527', '608', '260']
[DEBUG] predicted_ratings_top_n shape: (613, 102)
[DEBUG] Non-zero entries: 30650
[DEBUG] Max predicted rating: 5.112896117768185
Missing items: {'101362', '8984', '595', '2313', '3114', '349', '5481', '25868', '1405', '2100', '2153', '86', '2117', '337', '5729', '2006', '2989', '1375', '1380', '1923', '31522', '30793', '2788', '4638', '37380', '1246', '2114', '4723', '879', '6961', '254', '667', '2115', '616', '331', '451', '1594', '1963', '2118', '61123', '2690', '62999', '3083', '454', '2639', '8810', '8129', '93855', '1667', '342', '1956', '70', '1964', '2527', '2648', '4464', '1921', '647', '24', '1268', '69784', '2841', '86320', '4566', '111759', '8985', '1544', '21', '1023', '3112', '377', '74', '1049', '262', '2302', '4658', '3989', '798', '2148', '3079', '41571', '266', '841', '842', '154', '26680', '1939', '1363', '8951', '6609', '4958', '32582', '3103', '2761', '4228', '2721', '1369', '5064', '1792', '1672', '26712', '115210', '1590', '2141', '455', '3089', '233', '39414', '1994', '1422', '3476', '1535', '891', '426', '26', '1958', '2701', '1366', '160', '5881', '709', '8665', '1951', '8195', '2355', '6641', '215', '5319', '80241', '6947', '309', '1735', '2252', '2752', '1389', '8014', '714', '2058', '532', '2155', '1917', '2610', '71282', '708', '1688', '522', '648', '219', '27317', '509', '32444', '39446', '33495', '2993', '40826', '1266', '1865', '44022', '327', '425', '605', '5528', '8966', '510', '1587', '3168', '3097', '4034', '494', '3074', '4734', '2617', '74944', '1920', '1907', '227', '51540', '2616', '2004', '410', '551', '4587', '2297', '849', '4975', '81', '4232', '25753', '1841', '1377', '1678', '839', '3786', '5608', '2011', '2668', '47518', '339', '58', '56949', '2988', '105', '1975', '2088', '26842', '3581', '2459', '123', '252', '2779', '1895', '308', '4979', '581', '2134', '88744', '1997', '171', '697', '1414', '2728', '1271', '606', '661', '78041', '881', '1370', '289', '141', '2348', '1629', '824', '2565', '8874', '62', '140174', '81229', '249', '8016', '2144', '6593', '1999', '932', '637', '2753', '153', '26111', '1562', '4977', '3210', '1396', '1255', '3565', '5961', '326', '1882', '275', '345', '6058', '44004', '1586', '549', '2817', '5956', '3134', '2034', '670', '917', '4247', '537', '380', '26133', '104', '3763', '575', '471', '99', '54272', '2161', '2748', '27674', '2124', '3063', '902', '1948', '1845', '465', '2012', '168', '64983', '434', '2312', '543', '6957', '81847', '4896', '2151', '1024', '2892', '2613', '2135', '900', '3543', '1251', '28', '216', '4990', '1092', '2924', '1441', '44555', '1556', '1378', '239', '1583', '909', '1393', '2335', '47099', '4703', '534', '2087', '1608', '1391', '431', '2442', '3037', '42002', '8827', '3177', '38304', '4992', '59', '687', '6620', '1407', '1541', '1537', '4837', '1627', '2440', '640', '8833', '36401', '277', '85788', '145', '78088', '836', '7234', '3053', '4816', '1909', '1584', '79', '132', '986', '3556', '630', '186', '1262', '30', '25771', '742', '1499', '41569', '4641', '112', '54001', '42632', '47721', '4519', '4970', '6003', '236', '3052', '850', '5833', '4025', '45726', '951', '86332', '3766', '4727', '942', '2787', '609', '2860', '381', '1788', '4279', '565', '597', '315', '164', '2095', '2771', '711', '1702', '809', '1265', '2014', '5680', '1858', '46972', '500', '1093', '1269', '340', '1479', '46335', '2749', '1831', '102', '2005', '5066', '8464', '2142', '468', '481', '3594', '460', '5056', '1018', '761', '2022', '53000', '222', '198', '866', '2105', '4474', '3088', '833', '1967', '112460', '2109', '562', '88812', '1413', '90374', '3396', '15', '3577', '1162', '4482', '4701', '678', '74458', '2662', '7454', '553', '2269', '8366', '241', '4520', '1566', '2', '32031', '55765', '1721', '84152', '2929', '783', '1730', '84187', '272', '1253', '39183', '2262', '5686', '390', '1373', '1944', '2122', '3418', '2699', '2048', '2038', '63876', '94478', '4709', '466', '1552', '585', '1884', '931', '2447', '613', '247', '332', '1285', '231', '1888', '588', '46967', '213', '936', '2020', '84601', '8011', '424', '1779', '135', '1835', '203', '292', '6643', '1833', '4291', '1639', '185', '2160', '74545', '4676', '938', '7216', '2433', '2166', '1589', '1694', '8617', '3062', '1487', '33166', '6978', '2789', '55', '870', '673', '8860', '1648', '79008', '2116', '788', '2268', '64', '968', '436', '48385', '290', '4516', '1411', '2015', '2084', '393', '50189', '3004', '41566', '2791', '3469', '312', '2089', '4031', '650', '1615', '1416', '322', '628', '489', '155', '2003', '1726', '8584', '8970', '1836', '3638', '27721', '193', '4234', '467', '2734', '2333', '1892', '633', '314', '3479', '2671', '71254', '4928', '4643', '415', '837', '2112', '671', '799', '2321', '428', '31410', '668', '2069', '317', '8968', '89774', '2890', '25', '2501', '544', '3980', '2132', '280', '1873', '59387', '170', '948', '4191', '982', '892', '31685', '1966', '344', '79224', '784', '1616', '7445', '195', '2469', '3681', '2059', '43936', '32029', '492', '586', '52885', '7300', '225', '2769', '976', '71520', '26131', '165', '180', '47610', '765', '6934', '1848', '89', '40819', '2009', '780', '1772', '224', '2043', '26258', '45431', '1729', '63859', '6283', '1124', '2371', '1959', '635', '927', '955', '2334', '1249', '3077', '1641', '18', '1257', '1722', '3117', '407', '4880', '1785', '46976', '8363', '1992', '1911', '832', '1591', '8645', '2067', '53129', '614', '1635', '2976', '8908', '5876', '4255', '12', '5139', '3536', '2370', '5816', '3698', '1934', '63540', '1088', '2722', '2085', '1683', '80831', '4105', '14', '6473', '4133', '950', '2912', '1273', '2759', '8368', '96821', '612', '1593', '8948', '513', '694', '2266', '1051', '1885', '3937', '508', '55721', '502', '1281', '1717', '77561', '204', '4614', '1645', '440', '423', '1653', '762', '299', '1949', '7090', '482', '1644', '4887', '2966', '2263', '265', '2123', '3549', '4951', '8008', '2232', '6436', '49396', '67087', '378', '429', '2900', '53883', '5121', '89492', '1091', '3547', '4857', '2259', '490', '929', '3397', '5', '1374', '4546', '40629', '347', '1834', '1809', '1996', '1427', '3173', '22', '26326', '5483', '1924', '4369', '897', '848', '34334', '303', '6535', '3483', '36529', '2046', '65188', '810', '806', '2349', '45722', '662', '1957', '144', '1636', '1940', '590', '3178', '3030', '539', '338', '6970', '2539', '2082', '2687', '1597', '3061', '1713', '259', '2078', '4441', '300', '1701', '163', '1419', '31116', '804', '107406', '26810', '74510', '911', '177', '53519', '2071', '2107', '7451', '8128', '547', '427', '441', '1588', '5780', '458', '84944', '59333', '1875', '4443', '587', '2882', '1376', '2000', '1580', '6936', '5051', '5899', '2143', '5147', '4552', '2322', '4351', '653', '83613', '524', '2640', '2094', '531', '1429', '333', '116', '2470', '267', '6373', '2282', '2428', '552', '3527', '2080', '2133', '36519', '1631', '1863', '93840', '550', '158', '36527', '4254', '2642', '8373', '452', '1581', '4043', '691', '1665', '8337', '1894', '2575', '2139', '57353', '207', '3035', '3081', '122924', '2099', '74946', '253', '101', '2926', '73', '594', '507', '8987', '31696', '8973', '3160', '1611', '2239', '3101', '2097', '6537', '27706', '861', '1619', '2287', '802', '69406', '1985', '1913', '8194', '8981', '1995', '2694', '1807', '504', '6538', '830', '1573', '2202', '1125', '988', '3146', '2010', '350', '43919', '62956', '3011', '1277', '3179', '1245', '2033', '364', '4344', '5902', '558', '33660', '2253', '1371', '175', '1978', '4974', '546', '3511', '42011', '3175', '2255', '2288', '2657', '1687', '85414', '56152', '2002', '7980', '169', '3016', '3118', '928', '173', '2457', '42734', '627', '26614', '45186', '2516', '4978', '4012', '3701', '65', '3060', '3', '6552', '2436', '261', '535', '82', '5991', '1918', '2574', '69', '94959', '2104', '838', '1941', '2140', '288', '2044', '7091', '218', '5247', '1440', '800', '11', '4480', '1103', '107', '2463', '74948', '329', '58306', '2294', '2455', '2805', '25750', '95', '3489', '2111', '44694', '1485', '3598', '3057', '916', '5060', '805', '1887', '26776', '276', '98491', '6078', '435', '1372', '1673', '2108', '316', '442', '3699', '334', '4148', '4111', '5620', '1676', '6466', '196', '1690', '2001', '30707', '2162', '85', '596', '592', '540', '3051', '599', '72733', '7347', '1367', '1965', '3082', '3176', '1734', '54503', '2861', '5048', '348', '2383', '1260', '1059', '248', '3526', '3110', '1127', '3033', '480', '1633', '2017', '2528', '2605', '1991', '3090', '35957', '5927', '88', '388', '56801', '79553', '53435', '379', '64499', '97938', '2013', '1497', '1927', '2261', '1488', '1073', '2054', '2193', '1791', '1599', '3529', '1777', '831', '161', '6440', '8873', '786', '2125', '1950', '1620', '759', '383', '523', '114060', '3019', '3034', '3515', '3512', '4889', '1954', '2978', '3635', '20', '4823', '4956', '2770', '5061', '19', '818', '256', '914', '2171', '1783', '2110', '8371', '949', '5187', '2567', '2577', '52767', '1282', '475', '421', '1680', '2979', '4327', '172', '437', '1358', '2018', '94466', '1248'}
MF test predictions saved to: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-17_13-35-33/mf_test_100000_predictions.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-17_13-35-33/mmr_test_100000_cosine_top_50.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-17_13-35-33/mmr_test_100000_jaccard_top_50.csv
Pipeline for movies test finished successfully!
