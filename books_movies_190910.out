Running on ailab-l4-10
Start time: Tue Dec 16 04:36:01 CET 2025
Activating virtual environment...
Python path: /ceph/home/student.aau.dk/vo55zp/projects/P5/venv/bin/python3
Python version: Python 3.10.12
Running on ailab-l4-10
Start time: Tue Dec 16 04:36:01 CET 2025
Starting pipeline...

=== Running pipeline with weights: relevance=0.5, diversity=0.5 ===
Starting pipeline for movies train
Train matrix: (671, 1242), Val matrix: (610, 1242)
Best MF params: {'k': 60, 'alpha': 0.005, 'lambda_': 0.2}, RMSE=1.0411
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6502
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6564
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mf_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_04-36-37/mf_train_100000_loss_history.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Pipeline for movies train finished successfully!
Start movies test pipeline 
[DEBUG] Filtered users: 613
[DEBUG] Filtered items: 868
[DEBUG] Sample users: [2, 3, 4, 5, 6]
[DEBUG] Sample items: ['101', '102', '104', '1049', '105']
[DEBUG] Predicted ratings shape: (613, 868)
[DEBUG] Min/max predicted rating: 0.8305390614491499/5.705492834516667
MF predictions saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_04-36-37/mf_test_100000_top_50.csv
[DEBUG] Top-N CSV rows: 30650
[DEBUG] Unique users in CSV: 613
[DEBUG] Unique items in CSV: 92
[DEBUG] Sample rows:
   userId  rank  itemId  predictedRating
0       2     1     549         4.414122
1       2     2    1945         4.358058
2       2     3     858         4.341724
3       2     4     318         4.337373
4       2     5     905         4.319272
[DEBUG] Number of candidate items: 92
[DEBUG] Sample candidate items: ['549', '1945', '858', '318', '905']
[DEBUG] predicted_ratings_top_n shape: (613, 92)
[DEBUG] Non-zero entries: 30650
[DEBUG] Max predicted rating: 5.705492834516667
Missing items: {'2269', '6593', '65', '2010', '2261', '919', '2294', '1162', '26133', '2640', '327', '1687', '1092', '1809', '36519', '300', '1964', '2694', '2105', '48385', '1907', '1917', '158', '5060', '3011', '3418', '235', '107', '2890', '4823', '196', '1788', '31685', '4351', '173', '45431', '377', '2123', '49530', '74946', '169', '2028', '2699', '4148', '55765', '662', '1093', '1124', '879', '83613', '2109', '4995', '33166', '2759', '428', '3489', '502', '1371', '628', '46972', '52885', '539', '2012', '1992', '1959', '429', '830', '329', '47610', '39183', '2118', '1581', '4701', '597', '648', '986', '3527', '1836', '2959', '1389', '8966', '2094', '339', '3034', '4191', '63859', '85414', '3083', '590', '59387', '2038', '2193', '509', '2302', '81847', '1262', '1088', '141', '78088', '955', '942', '8368', '316', '1680', '1586', '2463', '8371', '2312', '596', '653', '6620', '711', '317', '809', '1213', '11', '1499', '1247', '471', '7445', '920', '1387', '1405', '2528', '535', '902', '4975', '2770', '594', '3210', '44694', '932', '1732', '1059', '1278', '3053', '81229', '3052', '2108', '249', '170', '1588', '350', '532', '586', '3081', '1090', '3556', '4709', '2006', '380', '3004', '1785', '1372', '2080', '2153', '31410', '3701', '4723', '2348', '5956', '1282', '616', '805', '93840', '524', '1688', '45722', '1544', '2268', '543', '204', '6643', '832', '3763', '4012', '3178', '86332', '1589', '2014', '2459', '84601', '1921', '1266', '1488', '1918', '783', '671', '54503', '3146', '1358', '6934', '18', '2046', '8981', '466', '6440', '2141', '2662', '691', '6957', '1393', '2003', '3114', '44191', '30707', '1887', '522', '53129', '551', '866', '3082', '102', '16', '1367', '4857', '213', '1734', '2239', '587', '2054', '227', '77561', '4247', '609', '8366', '1713', '804', '914', '1792', '2151', '457', '79553', '1958', '4734', '64', '84944', '3051', '186', '1726', '2125', '36529', '800', '2099', '3396', '345', '364', '2143', '3397', '5620', '1414', '2115', '3016', '494', '553', '1835', '6', '1391', '3483', '3635', '1772', '5902', '1127', '778', '185', '2989', '1951', '5528', '2266', '6436', '2161', '2371', '24', '40815', '261', '222', '5061', '8874', '6936', '88744', '982', '612', '5066', '2263', '1729', '6552', '1884', '562', '195', '97938', '1416', '3090', '1639', '2084', '3033', '3160', '288', '435', '3536', '4025', '198', '1611', '1257', '2966', '55721', '1562', '8014', '4880', '55', '53000', '3526', '40819', '2687', '15', '784', '85788', '2000', '550', '1892', '1954', '252', '292', '22', '74458', '36401', '1091', '2144', '1975', '436', '950', '1991', '6978', '497', '480', '2017', '58306', '1573', '2088', '2013', '5680', '94959', '2993', '442', '2383', '1645', '3168', '223', '163', '44022', '3581', '1956', '4228', '1244', '1944', '4031', '5121', '546', '540', '5816', '1479', '1377', '839', '673', '1366', '1396', '4011', '266', '1073', '1682', '2082', '637', '81', '39446', '1608', '2112', '334', '841', '2100', '2926', '2355', '2805', '1947', '17', '26712', '3594', '193', '1552', '3097', '1777', '20', '949', '6947', '647', '1653', '54001', '4886', '1885', '340', '1831', '51540', '4643', '2001', '1610', '8984', '59333', '262', '1911', '3175', '2111', '593', '1285', '89', '640', '1882', '260', '1641', '2122', '247', '2067', '383', '410', '41566', '2011', '2567', '2861', '331', '440', '592', '917', '1895', '276', '332', '900', '1485', '1875', '1949', '2139', '349', '1833', '4816', '2722', '1676', '6283', '806', '3', '2110', '4034', '3479', '2059', '46578', '3980', '455', '6373', '924', '482', '140174', '2701', '541', '2089', '1633', '172', '101', '4641', '64983', '110', '1249', '1580', '378', '7454', '2447', '1909', '2321', '50189', '3061', '1378', '2565', '155', '105', '7980', '2116', '2988', '1791', '1985', '342', '4441', '2436', '2605', '1407', '25', '2433', '280', '38061', '861', '2018', '5481', '481', '627', '88', '135', '1619', '2', '4255', '2527', '1591', '2142', '3101', '1997', '849', '4970', '454', '4977', '1923', '2232', '54272', '588', '1858', '1690', '4254', '4232', '4369', '4889', '558', '95', '165', '111759', '150', '1566', '2791', '595', '802', '1779', '2728', '3117', '3176', '145', '2297', '1678', '6003', '224', '207', '4638', '1673', '780', '441', '1373', '2022', '2124', '2160', '8810', '552', '2288', '2334', '2335', '42011', '2642', '337', '47099', '1374', '423', '123', '1375', '1615', '3173', '2005', '1957', '216', '1702', '8645', '2004', '1597', '8973', '1049', '2470', '1376', '492', '277', '2912', '1587', '30793', '2455', '788', '79', '799', '315', '1834', '293', '2002', '2539', '1594', '2457', '1593', '2134', '1246', '2015', '1894', '2166', '5147', '1103', '3699', '239', '2324', '1380', '1284', '344', '714', '5247', '2313', '3565', '241', '303', '379', '513', '2841', '2034', '434', '661', '6058', '5881', '8464', '2253', '338', '2978', '144', '314', '180', '1487', '2140', '112', '2779', '168', '47518', '46976', '225', '2291', '70', '2135', '231', '2860', '62999', '5', '6535', '381', '613', '2734', '5064', '909', '161', '2262', '2502', '58', '27721', '2428', '8665', '89492', '25750', '2657', '1272', '2078', '333', '1259', '62', '1265', '31696', '5686', '7451', '1967', '33660', '500', '891', '3578', '1125', '177', '2617', '272', '2333', '1251', '1717', '53519', '104', '82', '68954', '44004', '2761', '21', '265', '427', '2085', '1722', '7090', '3577', '1995', '2009', '2671', '348', '4958', '2749', '1968', '786', '2787', '3512', '256', '928', '4979', '8833', '678', '708', '215', '6537', '8011', '8970', '1961', '1556', '452', '762', '1888', '1394', '2069', '523', '40629', '45186', '431', '1721', '1584', '3060', '8985', '2395', '3698', '1271', '2349', '236', '14', '4344', '1590', '2033', '319', '838', '153', '910', '4974', '8961', '1370', '2282', '5991', '1950', '2252', '74510', '253', '160', '2114', '2058', '2087', '415', '3549', '798', '5483', '2616', '765', '8873', '585', '1994', '508', '2762', '531', '36527', '12', '3638', '5608', '84187', '837', '4896', '468', '1701', '605', '107406', '19', '1269'}
MF test predictions saved to: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_04-36-37/mf_test_100000_predictions.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_04-36-37/mmr_test_100000_cosine_top_50.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_04-36-37/mmr_test_100000_jaccard_top_50.csv
Pipeline for movies test finished successfully!
