Running on ailab-l4-10
Start time: Tue Dec 16 05:00:19 CET 2025
Activating virtual environment...
Python path: /ceph/home/student.aau.dk/vo55zp/projects/P5/venv/bin/python3
Python version: Python 3.10.12
Running on ailab-l4-10
Start time: Tue Dec 16 05:00:19 CET 2025
Starting pipeline...

=== Running pipeline with weights: relevance=0.5, diversity=0.5 ===
Starting pipeline for movies train
Train matrix: (671, 1242), Val matrix: (610, 1242)
Best MF params: {'k': 60, 'alpha': 0.005, 'lambda_': 0.2}, RMSE=1.0411
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6502
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6564
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mf_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_05-00-21/mf_train_100000_loss_history.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Pipeline for movies train finished successfully!
Start movies test pipeline 
[DEBUG] Filtered users: 613
[DEBUG] Filtered items: 868
[DEBUG] Sample users: [2, 3, 4, 5, 6]
[DEBUG] Sample items: ['101', '102', '104', '1049', '105']
[DEBUG] Predicted ratings shape: (613, 868)
[DEBUG] Min/max predicted rating: 0.8305390614491499/5.705492834516667
MF predictions saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_05-00-21/mf_test_100000_top_50.csv
[DEBUG] Top-N CSV rows: 30650
[DEBUG] Unique users in CSV: 613
[DEBUG] Unique items in CSV: 92
[DEBUG] Sample rows:
   userId  rank  itemId  predictedRating
0       2     1     549         4.414122
1       2     2    1945         4.358058
2       2     3     858         4.341724
3       2     4     318         4.337373
4       2     5     905         4.319272
[DEBUG] Number of candidate items: 92
[DEBUG] Sample candidate items: ['549', '1945', '858', '318', '905']
[DEBUG] predicted_ratings_top_n shape: (613, 92)
[DEBUG] Non-zero entries: 30650
[DEBUG] Max predicted rating: 5.705492834516667
Missing items: {'1717', '44022', '783', '1573', '1997', '7454', '45431', '2528', '2302', '1380', '340', '36401', '8874', '160', '40819', '48385', '44191', '1378', '2447', '110', '265', '5608', '1092', '293', '4709', '3418', '1247', '1641', '36519', '1788', '1885', '3081', '51540', '1918', '1682', '2142', '44004', '1586', '481', '1485', '280', '2239', '2312', '4723', '222', '806', '2605', '678', '6947', '350', '3701', '107406', '1479', '2033', '84944', '1991', '2288', '4889', '8014', '1975', '8833', '4344', '168', '3061', '1884', '1269', '2734', '74510', '14', '1721', '3483', '2166', '5991', '63859', '6957', '2252', '38061', '8368', '2082', '54272', '2054', '780', '1393', '1944', '8873', '466', '2694', '909', '231', '1584', '135', '2078', '2770', '53000', '1923', '804', '1734', '155', '5528', '316', '1688', '2762', '177', '1257', '17', '339', '36529', '235', '1093', '1414', '153', '345', '24', '4896', '198', '928', '97938', '2141', '4148', '2860', '2105', '2349', '101', '1374', '26133', '329', '5881', '6373', '3536', '2993', '509', '2687', '20', '2841', '1589', '2926', '765', '919', '799', '8966', '2067', '3082', '266', '788', '2749', '673', '47518', '1645', '1968', '1779', '1888', '2080', '2348', '1967', '1956', '3577', '1729', '2160', '1262', '2112', '123', '1259', '2084', '471', '49530', '5483', '74946', '3160', '3527', '383', '8984', '317', '924', '1371', '44694', '762', '1162', '1272', '637', '348', '1370', '1676', '169', '2151', '2253', '861', '26712', '338', '1653', '344', '595', '4734', '2058', '2567', '4232', '839', '5481', '982', '2989', '25750', '64983', '2115', '1284', '5', '33166', '88', '1921', '2004', '3581', '39183', '4247', '3016', '2861', '2779', '2759', '253', '252', '457', '65', '1593', '1619', '4638', '4255', '1375', '260', '949', '3011', '2123', '1809', '2118', '378', '3034', '4958', '288', '1049', '902', '364', '435', '809', '2433', '1894', '832', '1591', '36527', '172', '454', '84187', '85414', '1249', '1590', '303', '4034', '379', '500', '59333', '8973', '594', '1875', '2761', '3053', '3052', '3090', '558', '1957', '204', '4369', '550', '2015', '1556', '2912', '1882', '532', '482', '1562', '2144', '553', '6535', '3556', '342', '332', '3526', '3060', '50189', '800', '891', '8810', '647', '78088', '427', '12', '249', '377', '85788', '4643', '1690', '2099', '955', '55', '1544', '8961', '1213', '3594', '70', '6058', '1366', '1124', '2139', '86332', '2109', '236', '2313', '539', '1580', '2116', '4254', '2011', '1835', '4012', '5902', '1608', '261', '1673', '88744', '16', '2018', '2161', '480', '5060', '1405', '7980', '2034', '920', '31696', '440', '1964', '588', '1858', '2722', '2140', '107', '2143', '1594', '590', '2046', '4974', '1488', '62', '593', '55765', '2085', '1373', '2059', '585', '1407', '3114', '2334', '68954', '2012', '778', '900', '436', '4886', '54001', '170', '2263', '225', '2428', '2266', '3033', '2395', '140174', '2324', '47099', '1090', '551', '562', '613', '8981', '173', '2616', '3178', '195', '213', '1836', '15', '3489', '1958', '82', '40815', '150', '8366', '1285', '1726', '1073', '708', '11', '1959', '53519', '5121', '6537', '1127', '141', '79553', '1633', '5816', '2114', '2134', '47610', '4441', '3397', '272', '239', '4975', '30793', '442', '2100', '596', '2005', '22', '3146', '111759', '1611', '1678', '3117', '1091', '1282', '2122', '8011', '52885', '628', '41566', '932', '145', '163', '21', '31685', '81229', '4857', '4191', '102', '331', '2436', '333', '2087', '1994', '2539', '2787', '95', '6436', '2001', '837', '648', '2108', '59387', '46972', '2988', '4977', '6', '2022', '18', '1951', '2966', '1947', '640', '185', '4970', '1792', '337', '54503', '6593', '2383', '586', '81847', '1125', '3101', '3980', '186', '62999', '327', '4228', '2269', '3565', '531', '2335', '3051', '805', '8464', '1059', '1587', '2038', '917', '1376', '1377', '2232', '6643', '2642', '292', '540', '5247', '2657', '5066', '216', '4880', '2662', '39446', '1785', '161', '1251', '319', '1499', '1372', '786', '950', '5061', '609', '1950', '2013', '830', '262', '64', '2333', '3698', '535', '5956', '193', '3396', '5680', '2371', '2006', '1687', '1389', '552', '3004', '1581', '1265', '428', '1610', '46976', '2791', '3479', '112', '2111', '74458', '1396', '1833', '144', '55721', '19', '349', '2321', '3083', '3549', '468', '671', '1639', '165', '6440', '1552', '798', '2125', '714', '1834', '3097', '33660', '227', '523', '3699', '524', '841', '434', '224', '2805', '2', '8371', '1588', '89492', '1701', '592', '541', '241', '2502', '256', '2089', '1954', '196', '711', '3635', '2193', '223', '3168', '1732', '2268', '30707', '6936', '410', '2135', '866', '2282', '838', '1244', '1597', '104', '2527', '441', '1961', '497', '5064', '2455', '4701', '4979', '1394', '1615', '3', '8970', '81', '45186', '513', '276', '612', '2009', '2671', '429', '1266', '2463', '334', '77561', '79', '380', '4816', '1088', '1487', '494', '5620', '158', '2110', '1892', '986', '879', '2094', '7445', '2978', '3578', '784', '1722', '89', '4995', '1831', '2294', '1791', '8665', '1246', '8985', '105', '2010', '1271', '691', '3512', '492', '1895', '277', '7451', '1911', '42011', '3638', '1278', '2017', '543', '2459', '455', '1416', '2002', '2291', '6934', '1907', '1680', '661', '2088', '6552', '2261', '5686', '914', '40629', '546', '84601', '423', '314', '2890', '3175', '31410', '508', '587', '58306', '802', '381', '207', '247', '1566', '180', '46578', '605', '2728', '4351', '1995', '616', '83613', '4823', '1985', '4031', '1367', '2640', '6003', '6978', '1387', '2028', '1949', '2297', '3210', '3176', '2959', '849', '942', '93840', '502', '627', '1103', '1772', '1992', '2470', '2701', '215', '45722', '1887', '2153', '315', '1358', '2565', '415', '53129', '4011', '1909', '1713', '2355', '300', '5147', '6283', '2000', '58', '522', '27721', '2124', '653', '3763', '1777', '1917', '452', '2262', '2699', '3173', '6620', '2014', '25', '1391', '94959', '4025', '8645', '2617', '431', '662', '910', '7090', '2069', '2457', '1702', '2003', '4641', '597'}
MF test predictions saved to: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_05-00-21/mf_test_100000_predictions.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_05-00-21/mmr_test_100000_cosine_top_50.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_05-00-21/mmr_test_100000_jaccard_top_50.csv
Pipeline for movies test finished successfully!
