Running on ailab-l4-04
Start time: Tue Dec 16 14:40:49 CET 2025
Activating virtual environment...
Python path: /ceph/home/student.aau.dk/vo55zp/projects/P5/venv/bin/python3
Python version: Python 3.10.12
Running on ailab-l4-04
Start time: Tue Dec 16 14:40:49 CET 2025
Starting pipeline...

=== Running pipeline with weights: relevance=0.5, diversity=0.5 ===
Starting pipeline for movies train
Train matrix: (671, 1242), Val matrix: (610, 1242)
Best MF params: {'k': 60, 'alpha': 0.005, 'lambda_': 0.2}, RMSE=1.0411
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6483
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6539
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mf_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_14-41-23/mf_train_100000_loss_history.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Pipeline for movies train finished successfully!
Start movies test pipeline 
[DEBUG] Filtered users: 613
[DEBUG] Filtered items: 1242
[DEBUG] Sample users: [2, 3, 4, 5, 6]
[DEBUG] Sample items: ['101', '101362', '1018', '102', '1023']
[DEBUG] Predicted ratings shape: (613, 1242)
[DEBUG] Min/max predicted rating: 0.8305390614491499/5.737256786033441
MF predictions saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_14-41-23/mf_test_100000_top_50.csv
[DEBUG] Top-N CSV rows: 30650
[DEBUG] Unique users in CSV: 613
[DEBUG] Unique items in CSV: 108
[DEBUG] Sample rows:
   userId  rank  itemId  predictedRating
0       2     1     549         4.414122
1       2     2    2924         4.402179
2       2     3    1939         4.380564
3       2     4    1945         4.358058
4       2     5     858         4.341724
[DEBUG] Number of candidate items: 108
[DEBUG] Sample candidate items: ['549', '2924', '1939', '1945', '858']
[DEBUG] predicted_ratings_top_n shape: (613, 108)
[DEBUG] Non-zero entries: 30650
[DEBUG] Max predicted rating: 5.737256786033441
Missing items: {'648', '115210', '502', '410', '56949', '881', '742', '81847', '1726', '280', '1405', '2616', '2005', '1429', '2926', '2059', '47721', '79008', '4887', '504', '2789', '1927', '661', '8129', '1672', '122924', '6078', '175', '4234', '866', '1262', '2805', '650', '6957', '3063', '1587', '1917', '4974', '1125', '2912', '1683', '32029', '110', '596', '249', '39183', '1732', '2142', '97938', '59387', '1665', '3177', '1488', '6936', '1694', '2004', '2044', '513', '1792', '11', '46967', '1088', '4614', '203', '562', '381', '58559', '144', '1265', '256', '5927', '8833', '3057', '2988', '8961', '45726', '955', '7980', '2753', '193', '161', '39414', '465', '8011', '89774', '30793', '390', '1090', '327', '195', '171', '3074', '558', '48385', '1268', '3176', '235', '2046', '88812', '2118', '3547', '841', '3118', '332', '70', '761', '170', '59', '1991', '4676', '94478', '809', '1282', '2771', '41569', '1371', '2370', '3160', '3053', '3', '861', '942', '81229', '575', '101', '45186', '2699', '1611', '8584', '5', '69784', '3786', '806', '49396', '824', '3079', '45722', '552', '597', '3081', '4857', '427', '911', '26111', '316', '1940', '3479', '20', '86332', '2071', '709', '3210', '2080', '2084', '71254', '1610', '982', '65', '33166', '711', '112460', '891', '784', '5147', '3543', '164', '2900', '1644', '215', '6538', '594', '837', '74545', '1954', '1722', '216', '1992', '441', '1884', '2009', '1378', '88744', '62956', '27721', '150', '492', '2539', '261', '3556', '4995', '508', '5060', '2014', '539', '2151', '457', '153', '54503', '78088', '4823', '8874', '57353', '1639', '2349', '1785', '8014', '425', '50189', '38304', '836', '55', '6643', '4344', '1631', '950', '2605', '6283', '6535', '93855', '2297', '2668', '838', '2440', '1949', '4464', '64983', '2291', '2115', '64499', '2312', '1566', '6934', '3511', '1635', '1641', '4992', '489', '4896', '2447', '1608', '1920', '2141', '522', '1831', '3763', '31116', '1783', '173', '614', '2335', '948', '5056', '84601', '2148', '253', '1091', '32031', '2087', '4519', '2155', '4441', '4351', '2613', '1372', '2114', '2334', '818', '4970', '2788', '4990', '2322', '1791', '2107', '1591', '424', '3083', '1589', '1619', '510', '3034', '3489', '1944', '1580', '26', '1419', '1093', '6978', '1627', '1391', '1249', '5899', '616', '831', '254', '1999', '635', '2038', '276', '1676', '2759', '2134', '1247', '3060', '524', '222', '1369', '1788', '3175', '68954', '1887', '1717', '169', '1374', '342', '26614', '2125', '1599', '423', '585', '3114', '1924', '1772', '988', '1682', '697', '647', '25753', '900', '35957', '5816', '2455', '111759', '1594', '5481', '3179', '5061', '1414', '1653', '540', '383', '4480', '3396', '2259', '6003', '218', '8363', '466', '454', '196', '849', '1407', '595', '879', '25750', '364', '85788', '481', '185', '8951', '2978', '2959', '802', '708', '2966', '3173', '2639', '2989', '340', '2469', '2728', '4587', '93840', '4291', '89492', '1975', '1629', '2058', '897', '46976', '49530', '5833', '2020', '415', '788', '2252', '2433', '44694', '22', '1996', '67087', '2013', '8966', '3016', '4977', '2166', '1427', '2976', '2288', '36519', '2255', '79', '4889', '2011', '154', '47518', '2088', '74944', '7347', '2140', '917', '378', '1865', '1271', '1586', '165', '252', '53000', '637', '2841', '114060', '47099', '5066', '2527', '7454', '2', '2528', '8827', '804', '377', '45431', '8337', '1923', '15', '4816', '1485', '4474', '1836', '145', '1941', '329', '3937', '6593', '3004', '762', '4979', '546', '7451', '1907', '241', '2428', '3526', '3515', '36529', '2253', '8981', '6058', '1277', '2701', '5139', '8908', '673', '531', '2123', '1244', '936', '132', '2395', '986', '2567', '4643', '5187', '1858', '5121', '1985', '1690', '4369', '300', '160', '37380', '104', '2671', '2282', '1863', '2882', '1246', '56152', '687', '436', '56801', '5247', '1358', '1413', '293', '315', '4975', '78041', '4133', '105', '6440', '810', '6', '227', '2109', '910', '333', '101362', '55721', '1848', '535', '2640', '2501', '2817', '1049', '2470', '3090', '26680', '84152', '2383', '2748', '4734', '262', '77561', '1701', '43936', '480', '4703', '452', '303', '8617', '1947', '3483', '653', '312', '4886', '94959', '1950', '2110', '2124', '3578', '2463', '2860', '8970', '5319', '4247', '33660', '207', '4928', '319', '1497', '407', '2687', '46972', '2787', '2324', '1556', '500', '2028', '79553', '63876', '435', '1272', '74948', '292', '53883', '839', '1959', '259', '64', '2993', '8195', '7234', '1895', '17', '265', '63540', '976', '1535', '1833', '42011', '553', '4034', '2034', '1273', '1777', '662', '260', '1440', '1620', '2302', '1375', '4043', '1581', '26133', '938', '393', '5991', '1422', '1687', '2099', '870', '2761', '2143', '2610', '3577', '266', '4148', '1285', '2089', '38061', '455', '12', '1593', '8873', '799', '4516', '1779', '451', '19', '1616', '431', '1051', '2135', '40819', '314', '3594', '919', '2890', '1366', '4011', '8985', '543', '2263', '36527', '4031', '1809', '892', '2355', '59333', '2892', '3701', '275', '54001', '30707', '434', '112', '6620', '1911', '1888', '1257', '72733', '40815', '1978', '2232', '54272', '547', '5680', '2371', '2577', '2657', '928', '1487', '8008', '58', '2979', '8464', '924', '830', '1807', '25868', '44022', '4546', '471', '40826', '1073', '8665', '4025', '599', '18', '1376', '224', '627', '74', '1918', '5620', '39446', '800', '88', '4727', '2043', '3512', '25771', '5961', '3051', '1967', '247', '8973', '1588', '231', '140174', '334', '277', '8366', '31410', '90374', '6537', '1834', '909', '523', '267', '2779', '1584', '2078', '6552', '288', '80241', '1648', '26842', '44004', '3699', '96821', '62999', '74458', '4327', '1389', '8368', '2769', '1024', '2012', '2082', '2287', '1394', '2313', '1367', '4723', '58306', '2171', '186', '4958', '1380', '929', '83613', '34334', '2321', '1956', '338', '2734', '1023', '4956', '1127', '640', '107406', '668', '1994', '3082', '2108', '47610', '26258', '932', '612', '3766', '1721', '74946', '95', '2104', '79224', '337', '1957', '3536', '53435', '8194', '2111', '6373', '1441', '2770', '1284', '2069', '902', '2269', '2000', '8810', '833', '61123', '1841', '3980', '460', '1734', '509', '3033', '4482', '2752', '2018', '32444', '2565', '588', '1124', '8016', '497', '1961', '379', '3635', '223', '4638', '6641', '52885', '31685', '1259', '590', '2642', '2122', '949', '442', '388', '172', '691', '1882', '4520', '3397', '1377', '32582', '5608', '46335', '786', '5686', '1965', '3529', '4837', '1958', '1680', '2015', '239', '2239', '2502', '4012', '1894', '3011', '2003', '348', '2006', '2574', '3681', '1266', '551', '694', '5729', '2762', '1573', '65188', '1387', '507', '345', '490', '1885', '1092', '42002', '8987', '3549', '63859', '4709', '236', '180', '33495', '605', '289', '51540', '586', '1615', '2261', '2033', '8968', '85414', '1562', '920', '102', '7090', '4279', '2333', '4978', '14', '494', '2662', '8984', '1966', '2791', '421', '1479', '2861', '429', '2722', '4111', '541', '168', '8948', '4255', '1951', '1667', '482', '2694', '380', '26776', '6961', '6466', '86320', '832', '44191', '1645', '248', '1873', '27674', '46578', '2139', '1875', '2617', '3168', '2105', '2457', '204', '1162', '1541', '1688', '428', '537', '107', '1921', '74510', '550', '1396', '2144', '331', '5064', '81', '1278', '1544', '6970', '21', '99', '84944', '2094', '2022', '914', '2153', '1835', '848', '42734', '71282', '2161', '2294', '1735', '1713', '30', '2100', '53519', '2575', '3598', '73', '2193', '2133', '2160', '4566', '1892', '1089', '1702', '4443', '678', '671', '5956', '3097', '1597', '2048', '1393', '219', '62', '805', '80831', '458', '272', '778', '468', '6609', '798', '1636', '3581', '1997', '213', '2516', '82', '5483', '3146', '1416', '1251', '2116', '1018', '765', '26712', '606', '2017', '163', '317', '4552', '3698', '2117', '2095', '4191', '42632', '2001', '2459', '2162', '225', '714', '8373', '630', '322', '426', '1269', '299', '3565', '1370', '5051', '628', '2112', '6947', '3061', '347', '4105', '43919', '759', '31696', '1729', '3178', '198', '667', '4658', '41566', '84187', '25', '780', '5780', '158', '1964', '3638', '3527', '1995', '350', '437', '1245', '8371', '8645', '2010', '36401', '3117', '5902', '5048', '2097', '1909', '4951', '4641', '86', '155', '7300', '3101', '27706', '85', '349', '1213', '842', '2348', '467', '339', '1590', '4880', '609', '26810', '1678', '1583', '1499', '4701', '71520', '3418', '2436', '1363', '2085', '4232', '4254', '3103', '2749', '592', '783', '2266', '6473', '1059', '3052', '2067', '2054', '40629', '31522', '123', '1103', '16', '5528', '4228', '7445', '177', '1552', '24', '2268', '344', '1968', '5881', '41571', '55765', '3110', '94466', '141', '1673', '532', '7216', '440', '613', '69406', '587', '633', '8860', '593', '6436', '670', '1730', '89', '931', '135', '53129', '2002', '2262', '544', '1373', '1633'}
MF test predictions saved to: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_14-41-23/mf_test_100000_predictions.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_14-41-23/mmr_test_100000_cosine_top_50.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_14-41-23/mmr_test_100000_jaccard_top_50.csv
Pipeline for movies test finished successfully!
