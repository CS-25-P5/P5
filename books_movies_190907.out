Running on ailab-l4-09
Start time: Tue Dec 16 03:27:33 CET 2025
Activating virtual environment...
Python path: /ceph/home/student.aau.dk/vo55zp/projects/P5/venv/bin/python3
Python version: Python 3.10.12
Running on ailab-l4-09
Start time: Tue Dec 16 03:27:33 CET 2025
Starting pipeline...

=== Running pipeline with weights: relevance=0.5, diversity=0.5 ===
Starting pipeline for movies train
Train matrix: (671, 1242), Val matrix: (610, 1242)
Best MF params: {'k': 60, 'alpha': 0.005, 'lambda_': 0.2}, RMSE=1.0411
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6502
Validation data: 4394 ratings
Item IDs length: 1242
Max column index: 1241
Best lambda: 0.0 with score 0.6564
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mf_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_03-27-35/mf_train_100000_loss_history.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Logged experiment to /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/mmr_train_experiment_log.csv
Pipeline for movies train finished successfully!
Start movies test pipeline 
[DEBUG] Filtered users: 613
[DEBUG] Filtered items: 868
[DEBUG] Sample users: [2, 3, 4, 5, 6]
[DEBUG] Sample items: ['101', '102', '104', '1049', '105']
[DEBUG] Predicted ratings shape: (613, 868)
[DEBUG] Min/max predicted rating: 0.8305390614491499/5.705492834516667
MF predictions saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_03-27-35/mf_test_100000_top_50.csv
[DEBUG] Top-N CSV rows: 30650
[DEBUG] Unique users in CSV: 613
[DEBUG] Unique items in CSV: 92
[DEBUG] Sample rows:
   userId  rank  itemId  predictedRating
0       2     1     549         4.414122
1       2     2    1945         4.358058
2       2     3     858         4.341724
3       2     4     318         4.337373
4       2     5     905         4.319272
[DEBUG] Number of candidate items: 92
[DEBUG] Sample candidate items: ['549', '1945', '858', '318', '905']
[DEBUG] predicted_ratings_top_n shape: (613, 92)
[DEBUG] Non-zero entries: 30650
[DEBUG] Max predicted rating: 5.705492834516667
Missing items: {'39183', '150', '97938', '88', '3980', '440', '170', '1791', '1722', '799', '1772', '36519', '1378', '861', '30707', '2110', '22', '81', '986', '2239', '2000', '2805', '6643', '84187', '41566', '2266', '2787', '661', '786', '2082', '235', '1389', '1584', '2662', '1875', '6436', '2263', '4975', '5816', '222', '3175', '8371', '1690', '2890', '1673', '261', '77561', '1732', '1992', '2841', '1127', '539', '6003', '535', '288', '84601', '2139', '315', '932', '1391', '1633', '2033', '2455', '4034', '2034', '4254', '3033', '4344', '3699', '673', '4958', '1162', '81847', '1619', '541', '1676', '5620', '8810', '207', '1414', '1125', '27721', '1688', '1682', '3083', '3536', '3526', '532', '5481', '338', '2099', '215', '4228', '53000', '849', '364', '1921', '1967', '2978', '4857', '2153', '910', '593', '145', '253', '1266', '2791', '436', '1641', '47610', '1792', '457', '2085', '949', '2349', '5608', '198', '2734', '442', '1909', '2084', '1371', '186', '319', '44694', '53129', '6947', '6283', '1544', '168', '2193', '7090', '26712', '2470', '2166', '2282', '378', '33660', '1093', '3053', '1680', '2144', '317', '36527', '920', '6440', '2640', '5147', '2617', '2067', '49530', '4995', '4896', '3034', '551', '8665', '552', '4369', '1272', '83613', '3090', '671', '1950', '1833', '101', '2463', '5902', '2333', '585', '5686', '1073', '196', '2671', '616', '153', '88744', '3565', '58306', '2134', '51540', '523', '344', '8464', '47099', '110', '2087', '2539', '33166', '104', '879', '2142', '177', '2005', '2722', '2124', '303', '3101', '2657', '2959', '1262', '195', '331', '783', '169', '455', '163', '558', '778', '804', '1589', '1788', '1597', '44022', '2926', '227', '8973', '2860', '225', '2459', '2151', '8014', '1562', '806', '2011', '16', '2141', '64', '1729', '327', '193', '2288', '1610', '2253', '2100', '2002', '54503', '2447', '1246', '2383', '2321', '3052', '662', '1124', '543', '1836', '1366', '3178', '8366', '172', '2759', '25', '1964', '94959', '950', '1888', '8874', '123', '107406', '1581', '2014', '2022', '830', '1393', '1917', '1552', '2749', '40815', '1282', '1835', '1479', '2701', '2058', '1645', '3763', '4970', '1591', '1892', '1372', '2291', '236', '1593', '5121', '2761', '40629', '553', '1587', '3082', '452', '348', '7980', '1834', '3051', '155', '272', '1566', '84944', '85414', '1380', '262', '540', '3061', '158', '2268', '11', '3173', '1374', '4232', '2616', '292', '3', '47518', '7445', '78088', '140174', '2457', '1956', '928', '185', '2335', '1271', '1090', '1994', '1721', '8833', '1882', '46976', '39446', '714', '1968', '1407', '497', '2989', '44191', '332', '377', '223', '2687', '802', '609', '42011', '2912', '342', '2112', '2261', '24', '40819', '502', '594', '4723', '293', '2160', '3004', '5061', '587', '2123', '2642', '52885', '982', '2567', '1375', '1858', '2395', '1265', '6978', '8873', '428', '1059', '6620', '2371', '256', '605', '2502', '508', '1887', '2069', '841', '3418', '3396', '2527', '3577', '4351', '838', '4012', '637', '513', '4889', '914', '252', '55765', '1488', '180', '1809', '379', '1594', '612', '8368', '1249', '1590', '2004', '7451', '79553', '2348', '2094', '4974', '2', '550', '468', '1777', '1586', '2001', '2297', '1251', '6936', '3176', '74946', '1985', '30793', '334', '345', '350', '45431', '1088', '3397', '1954', '2038', '592', '481', '1713', '441', '531', '1717', '2122', '44004', '112', '1485', '1957', '4977', '3114', '613', '64983', '63859', '1726', '339', '3060', '316', '89', '866', '48385', '340', '1487', '2118', '1573', '2143', '6593', '2779', '765', '74510', '65', '68954', '597', '55', '2433', '1997', '276', '6373', '1091', '1588', '1975', '1370', '2003', '2059', '2140', '595', '15', '5991', '14', '2988', '1405', '1884', '2125', '1387', '1958', '942', '50189', '6934', '31696', '466', '2262', '2006', '3556', '55721', '1923', '86332', '2028', '135', '1991', '3081', '784', '3011', '640', '919', '31410', '3489', '902', '423', '1244', '522', '524', '5064', '839', '588', '45722', '427', '434', '4638', '8984', '1611', '111759', '482', '247', '1918', '1396', '381', '500', '1885', '224', '2993', '161', '277', '314', '2111', '3527', '79', '54001', '74458', '909', '12', '1779', '95', '788', '4441', '102', '45186', '509', '1394', '429', '8985', '900', '4816', '1959', '1499', '1911', '38061', '329', '19', '300', '3635', '435', '4823', '6957', '3479', '3483', '8645', '1608', '62', '648', '105', '2054', '1701', '107', '2017', '213', '2762', '1961', '241', '2312', '492', '628', '1377', '2010', '3581', '4886', '4191', '2355', '1895', '1831', '2252', '349', '1103', '26133', '204', '249', '4979', '8966', '4247', '1269', '431', '7454', '36401', '2046', '1247', '2115', '832', '1653', '2012', '2861', '1678', '21', '837', '2334', '383', '678', '562', '809', '265', '231', '2018', '5066', '1615', '59387', '1049', '480', '3549', '6537', '590', '280', '3698', '4709', '780', '3638', '2269', '8970', '2114', '494', '805', '798', '1907', '85788', '2135', '46972', '260', '3594', '1092', '6535', '2528', '6', '4011', '653', '1257', '4031', '1639', '1285', '2108', '2313', '2605', '596', '2013', '1702', '25750', '5247', '20', '3512', '711', '2436', '239', '2302', '2728', '333', '8961', '165', '4255', '410', '1213', '2015', '1358', '3117', '2105', '3210', '2009', '144', '93840', '58', '2232', '81229', '18', '3146', '62999', '2770', '53519', '17', '173', '2294', '2161', '4880', '1278', '4025', '1284', '337', '1947', '1687', '4148', '415', '1580', '1367', '380', '59333', '800', '5680', '89492', '2116', '955', '82', '2089', '1734', '1556', '891', '2428', '1416', '924', '2080', '3578', '1785', '2694', '2088', '3097', '8011', '36529', '2109', '54272', '3701', '4701', '6058', '141', '2966', '2699', '627', '647', '4734', '471', '70', '5483', '3168', '5060', '1995', '8981', '46578', '691', '762', '1259', '1951', '1944', '708', '1376', '917', '546', '5956', '1894', '266', '2078', '5528', '160', '454', '1949', '2324', '4643', '5881', '6552', '3160', '586', '3016', '216', '2565', '31685', '4641', '5', '1373'}
MF test predictions saved to: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_03-27-35/mf_test_100000_predictions.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_03-27-35/mmr_test_100000_cosine_top_50.csv
MMR results saved: /ceph/home/student.aau.dk/vo55zp/projects/P5/src/MMR/../datasets/mmr_data/movies/2025-12-16_03-27-35/mmr_test_100000_jaccard_top_50.csv
Pipeline for movies test finished successfully!
